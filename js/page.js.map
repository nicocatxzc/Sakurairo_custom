{"version":3,"file":"page.js","mappings":"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","sources":["webpack://sakurairo-scripts/./src/page/global-func.js","webpack://sakurairo-scripts/./node_modules/charenc/charenc.js","webpack://sakurairo-scripts/./src/page/artile_attachment/index.ts","webpack://sakurairo-scripts/./src/page/artile_attachment/math.ts","webpack://sakurairo-scripts/./src/page/gravatar.ts","webpack://sakurairo-scripts/./src/page/getqqinfo.js","webpack://sakurairo-scripts/./src/page/AddComment.ts","webpack://sakurairo-scripts/./src/page/pagination.ts","webpack://sakurairo-scripts/./src/page/emoji.js","webpack://sakurairo-scripts/./src/page/annotation.js","webpack://sakurairo-scripts/./src/page/link_form.js","webpack://sakurairo-scripts/./src/page/steam_card.js","webpack://sakurairo-scripts/./src/page/ghcard_theme.js","webpack://sakurairo-scripts/./src/page/time_archive.js","webpack://sakurairo-scripts/./src/page/bili_fav.js","webpack://sakurairo-scripts/./src/page/comment_captcha.js","webpack://sakurairo-scripts/./src/page/index.js","webpack://sakurairo-scripts/./node_modules/@mui/utils/esm/debounce/debounce.js","webpack://sakurairo-scripts/./node_modules/md5/md5.js","webpack://sakurairo-scripts/./node_modules/crypt/crypt.js","webpack://sakurairo-scripts/./node_modules/is-buffer/index.js"],"sourcesContent":["function grin(tag, type, before, after) {\r\n    const myField = document.getElementById('comment');\r\n    if (!myField || myField.type != 'textarea') {\r\n        return false;\r\n    }\r\n    switch (type) {\r\n        case \"custom\": tag = before + tag + after; break;\r\n        case \"Img\": tag = '[img]' + tag + '[/img]'; break;\r\n        case \"Math\": tag = ' {{' + tag + '}} '; break;\r\n        case \"tieba\": tag = ' ::' + tag + ':: '; break;\r\n        default: tag = ' :' + tag + ': ';\r\n    }\r\n/*     if (document.selection) {\r\n        myField.focus();\r\n        const sel = document.selection.createRange();\r\n        sel.text = tag;\r\n        myField.focus();\r\n    } else */ if (myField.selectionStart || myField.selectionStart == '0') {\r\n        let startPos = myField.selectionStart,\r\n            endPos = myField.selectionEnd,\r\n            cursorPos = endPos;\r\n        myField.value = myField.value.substring(0, startPos) + tag + myField.value.substring(endPos, myField.value.length);\r\n        cursorPos += tag.length;\r\n        myField.focus();\r\n        myField.selectionStart = cursorPos;\r\n        myField.selectionEnd = cursorPos;\r\n    } else {\r\n        myField.value += tag;\r\n        myField.focus();\r\n    }\r\n}\r\nwindow.grin = grin\r\n","var charenc = {\n  // UTF-8 encoding\n  utf8: {\n    // Convert a string to a byte array\n    stringToBytes: function(str) {\n      return charenc.bin.stringToBytes(unescape(encodeURIComponent(str)));\n    },\n\n    // Convert a byte array to a string\n    bytesToString: function(bytes) {\n      return decodeURIComponent(escape(charenc.bin.bytesToString(bytes)));\n    }\n  },\n\n  // Binary encoding\n  bin: {\n    // Convert a string to a byte array\n    stringToBytes: function(str) {\n      for (var bytes = [], i = 0; i < str.length; i++)\n        bytes.push(str.charCodeAt(i) & 0xFF);\n      return bytes;\n    },\n\n    // Convert a byte array to a string\n    bytesToString: function(bytes) {\n      for (var str = [], i = 0; i < bytes.length; i++)\n        str.push(String.fromCharCode(bytes[i]));\n      return str.join('');\n    }\n  }\n};\n\nmodule.exports = charenc;\n","import { loadCSS } from 'fg-loadcss';\nimport { slideToggle } from '../../common/util';\nimport { resolvePath, importExternal } from '../../common/npmLib';\nimport math from './math';\nfunction collapse() {\n    //收缩、展开\n    /* jQuery(document).ready(\n    function(jQuery){\n        jQuery('.collapseButton').click(function(){\n        jQuery(this).parent().parent().find('.xContent').slideToggle('slow');\n        });\n        }) */\n    const collapseButtons = document.getElementsByClassName('collapseButton');\n    if (collapseButtons.length > 0) {\n        const collapseListener = (e) => {\n            slideToggle(e.currentTarget.nextElementSibling);\n        };\n        for (const ele of collapseButtons) {\n            ele.addEventListener(\"click\", collapseListener);\n        }\n        // import('jquery').then(({ default: jQuery }) => {\n        //     jQuery('.collapseButton').on(\"click\", function () {\n        //         jQuery(this).parent().parent().find('.xContent').slideToggle('slow');\n        //     })\n        // })\n    }\n}\nlet lightBoxCSS;\nasync function lightbox() {\n    //init lightbox\n    if (_iro.baguetteBox) {\n        if (!lightBoxCSS)\n            lightBoxCSS = loadCSS(resolvePath('dist/baguetteBox.min.css', 'baguettebox.js', '1.11.1'));\n        //@ts-ignore\n        const { default: baguetteBox } = await import('baguettebox.js');\n        baguetteBox.run('.entry-content', {\n            captions: function (element) {\n                return element.getElementsByTagName('img')[0].alt;\n            },\n            ignoreClass: 'fancybox',\n        });\n    }\n    else if (_iro.fancybox) {\n        if (!lightBoxCSS)\n            lightBoxCSS = loadCSS(resolvePath('dist/jquery.fancybox.min.css', '@fancyapps/fancybox'));\n        if (!((window.jQuery instanceof Function) || (window.$ instanceof Function))) {\n            if (_iro.ext_shared_lib) {\n                importExternal('dist/jquery.slim.min.js', 'jquery');\n            }\n            else {\n                //@ts-ignore\n                const { default: jQuery } = await import('jquery');\n                window.$ = jQuery;\n                window.jQuery = jQuery;\n            }\n        }\n        if (_iro.ext_shared_lib) {\n            importExternal('dist/jquery.fancybox.min.js', '@fancyapps/fancybox');\n        }\n        else {\n            //@ts-ignore\n            import('@fancyapps/fancybox');\n        }\n    }\n    else if (_iro.lightGallery) {\n        //lightGallery的umd导入有点问题\n        /*         if (_iro.ext_shared_lib) {\n                    if (!window.lightGallery) {\n                        loadCSS(resolvePath('css/lightgallery-bundle.min.css', 'lightgallery', '2.3.0'))\n                        await importExternal('lightgallery.umd.js', 'lightgallery')\n                    }\n                    const { plugins } = _iro.lightGallery\n                    if (plugins) {\n                        (await Promise\n                            .allSettled(\n                                plugins.map((name: string) => importExternal('plugins/' + solvePluginName(name)+'.umd.js', 'lightgallery'))\n                            ))\n                            .map(handleResult)\n                    }\n                    window.lightGallery(\n                        document.querySelector('.entry-content'),\n                        _iro.lightGallery);\n                } else {\n                    //@ts-ignore\n                    const { default: initLightGallery } = await import('./lightGallery/import')\n                    initLightGallery()\n                } */\n        const { default: initLightGallery } = await import('../lightGallery/import');\n        initLightGallery();\n    }\n}\nexport default function article_attach() {\n    collapse();\n    lightbox();\n    math();\n}\n","import { resolvePath } from '../../common/npmLib';\nexport default async function math() {\n    if (_iro.theme_mathjax &&\n        (document.getElementsByTagName('math').length > 0 ||\n            document.querySelector('article > div.entry-content')?.textContent.match(/(?:\\$|\\\\\\(|\\\\\\[|\\\\begin\\{.*?})/))) {\n        if (!('MathJax' in window)) {\n            const mathjaxConfig = {\n                tex: {\n                    inlineMath: [['$', '$'], ['\\\\(', '\\\\)']]\n                },\n                startup: {\n                    typeset: false, // Perform initial typeset?\n                },\n                chtml: {\n                    fontURL: resolvePath('es5/output/chtml/fonts/woff-v2', 'mathjax'),\n                    mathmlSpacing: true // true for MathML spacing rules, false for TeX rules\n                }\n            };\n            //@ts-ignore\n            window.MathJax = mathjaxConfig;\n        }\n        //@ts-ignore\n        await import('mathjax/es5/tex-mml-chtml');\n        //@ts-ignore\n        window.MathJax.typesetPromise();\n    }\n}\n","import MD5 from 'md5';\n/**\n * Gravatar\n * from a6cd66c 11.third-part-functions.js\n */\nexport const get_gravatar = (email, size = 80) => 'https://' + _iro.gravatar_url + '/' + MD5(email) + '.jpg?s=' + size + '&d=mm';\n","import { buildAPI } from '../common/util'\r\nimport { get_gravatar } from './gravatar'\r\n\r\nexport default function getqqinfo() {\r\n    let is_get_by_qq = false;\r\n    const i_author = document.querySelector(\"input#author\"),\r\n        i_qq = document.querySelector(\"input#qq\"),\r\n        i_email = document.querySelector(\"input#email\"),\r\n        i_url = document.querySelector(\"input#url\"),\r\n        qq_check = document.querySelector(\".qq-check\"),\r\n        gravatar_check = document.querySelector(\".gravatar-check\"),\r\n        user_avatar_img = document.querySelector(\"div.comment-user-avatar img\");\r\n    if (i_author == null) return;\r\n    if (!localStorage.getItem('user_qq') && !localStorage.getItem('user_qq_email') && !localStorage.getItem('user_author')) {\r\n        i_qq.value = i_author.value = i_email.value = i_url.value = \"\";\r\n    }\r\n    if (localStorage.getItem('user_avatar') && localStorage.getItem('user_qq') && localStorage.getItem('user_qq_email')) {\r\n        user_avatar_img.setAttribute('src', localStorage.getItem('user_avatar'));\r\n        i_author.value = localStorage.getItem('user_author');\r\n        i_email.value = localStorage.getItem('user_qq') + '@qq.com';\r\n        i_qq.value = localStorage.getItem('user_qq');\r\n        if (_iro.qzone_autocomplete) {\r\n            i_url.value = 'https://user.qzone.qq.com/' + localStorage.getItem('user_qq');\r\n        }\r\n        if (i_qq.value) {\r\n            qq_check.style.display = \"block\";\r\n            gravatar_check.style.display = \"none\";\r\n        }\r\n    }\r\n    let emailAddressFlag = i_email.value;\r\n    //var emailAddressFlag = cached.filter('#email').val();\r\n    i_author.addEventListener('blur', () => {\r\n        // })\r\n        //cached.filter('#author').on('blur', function () {\r\n        const qq = i_author.value,\r\n            reg_QQ = /^[1-9]\\d{4,9}$/;\r\n        if (reg_QQ.test(qq)) {\r\n            const whileFailed = () => {\r\n                i_qq.value = '';\r\n                qq_check.style.display = 'none';\r\n                gravatar_check.style.display = 'block';\r\n                user_avatar_img.setAttribute('src', get_gravatar(i_email.value, 80));\r\n                localStorage.setItem('user_qq', '');\r\n                localStorage.setItem('user_email', i_email.value);\r\n                localStorage.setItem('user_avatar', get_gravatar(i_email.value, 80));\r\n                /***/\r\n                /*         qq.value = email.value = url.value = \"\";\r\n                        if (!qq.value) {\r\n                            qq_check.style.display = 'none';\r\n                            gravatar_check.style.display = 'block';\r\n                            setCookie('user_qq', '', 30);\r\n                            user_avatar_img.setAttribute('src', get_gravatar(email.value, 80));\r\n                            setCookie('user_avatar', get_gravatar(email.value, 80), 30);\r\n                        } */\r\n            }\r\n            fetch(buildAPI(_iro.qq_api_url, { qq: qq }))\r\n                .then(async resp => {\r\n                    if (resp.ok) {\r\n                        //success\r\n                        try {\r\n                            const data = await resp.json()\r\n                            i_author.value = data.name;\r\n                            i_email.value = qq.trim() + '@qq.com';\r\n                            if (_iro.qzone_autocomplete) {\r\n                                i_url.value = 'https://user.qzone.qq.com/' + qq.trim();\r\n                            }\r\n                            user_avatar_img.setAttribute('src', 'https://q2.qlogo.cn/headimg_dl?dst_uin=' + qq + '&spec=100');\r\n                            is_get_by_qq = true;\r\n                            i_qq.value = qq.trim();\r\n                            if (i_qq.value) {\r\n                                qq_check.style.display = 'block';\r\n                                gravatar_check.style.display = 'none';\r\n                            }\r\n                            localStorage.setItem('user_author', data.name);\r\n                            localStorage.setItem('user_qq', qq);\r\n                            localStorage.setItem('is_user_qq', 'yes');\r\n                            localStorage.setItem('user_qq_email', qq + '@qq.com');\r\n                            localStorage.setItem('user_email', qq + '@qq.com');\r\n                            emailAddressFlag = i_email.value;\r\n                            /***/\r\n                            user_avatar_img.setAttribute('src', data.avatar);\r\n                            localStorage.setItem('user_avatar', data.avatar);\r\n                        } catch (e) {\r\n                            console.warn(e)\r\n                            whileFailed()\r\n                        }\r\n                    } else {\r\n                        whileFailed()\r\n                    }\r\n                })\r\n        }\r\n    });\r\n    if (localStorage.getItem('user_avatar') && localStorage.getItem('user_email') && localStorage.getItem('is_user_qq') == 'no' && !localStorage.getItem('user_qq_email')) {\r\n        user_avatar_img.setAttribute(\"src\", localStorage.getItem('user_avatar'));\r\n        i_email.value = localStorage.getItem('user_mail');\r\n        i_qq.value = '';\r\n        if (!i_qq.value) {\r\n            qq_check.style.display = \"none\";\r\n            gravatar_check.style.display = \"block\";\r\n        }\r\n        // $('div.comment-user-avatar img').attr('src', getCookie('user_avatar'));\r\n        // cached.filter('#email').val(getCookie('user_email'));\r\n        // cached.filter('#qq').val('');\r\n        // if (!cached.filter('#qq').val()) {\r\n        //     $('.qq-check').css('display', 'none');\r\n        //     $('.gravatar-check').css('display', 'block');\r\n        // }\r\n    }\r\n    i_email.addEventListener(\"blur\", function () {\r\n        //cached.filter('#email').on('blur', function () {\r\n        let emailAddress = i_email.value;\r\n        // var emailAddress = cached.filter('#email').val();\r\n        if ((is_get_by_qq == false || emailAddressFlag != emailAddress) && emailAddress != '') {\r\n            user_avatar_img.setAttribute(\"src\", get_gravatar(emailAddress, 80));\r\n            //$('div.comment-user-avatar img').attr('src', get_gravatar(emailAddress, 80));\r\n            localStorage.setItem('user_avatar', get_gravatar(emailAddress, 80));\r\n            localStorage.setItem('user_email', emailAddress);\r\n            localStorage.setItem('user_qq_email', '');\r\n            localStorage.setItem('is_user_qq', 'no');\r\n            i_qq.value = '';\r\n            // cached.filter('#qq').val('');\r\n            if (!i_qq.value) {\r\n                qq_check.style.display = \"none\";\r\n                gravatar_check.style.display = \"block\";\r\n                // $('.qq-check').css('display', 'none');\r\n                // $('.gravatar-check').css('display', 'block');\r\n            }\r\n        }\r\n    });\r\n    if (localStorage.getItem('user_url')) {\r\n        i_url.value = localStorage.getItem(\"user_url\");\r\n        // cached.filter('#url').val(getCookie('user_url'));\r\n    }\r\n    i_url.addEventListener(\"blur\", function () {\r\n        //cached.filter('#url').on('blur', function () {\r\n        let URL_Address = i_url.value;\r\n        i_url.value = URL_Address;\r\n        // var URL_Address = cached.filter('#url').val();\r\n        // cached.filter('#url').val(URL_Address);\r\n        localStorage.setItem('user_url', URL_Address);\r\n    });\r\n    if (localStorage.getItem('user_author')) {\r\n        i_author.value = localStorage.getItem('user_author');\r\n        // cached.filter('#author').val(getCookie('user_author'));\r\n    }\r\n    i_author.addEventListener(\"blur\", function () {\r\n        // cached.filter('#author').on('blur', function () {\r\n        let user_name = i_author.value;\r\n        i_author.value = user_name;\r\n        // var user_name = cached.filter('#author').val();\r\n        // cached.filter('#author').val(user_name);\r\n        localStorage.setItem('user_author', user_name);\r\n    });\r\n}","const AddComment = {\n    respondId: '',\n    moveForm: function (commId, parentId, respondId) {\n        const comm = document.getElementById(commId), respond = document.getElementById(respondId), cancel = document.getElementById('cancel-comment-reply-link'), parent = document.getElementById('comment_parent');\n        //post = document.getElementById('comment_post_ID');\n        this.respondId = respondId;\n        if (!document.getElementById('wp-temp-form-div')) {\n            const div = document.createElement('div');\n            div.id = 'wp-temp-form-div';\n            div.style.display = 'none';\n            respond.parentNode.insertBefore(div, respond);\n        }\n        if (!comm) {\n            const temp = document.getElementById('wp-temp-form-div');\n            document.getElementById('comment_parent').value = '0';\n            temp.parentNode.insertBefore(respond, temp);\n            temp.remove();\n        }\n        else {\n            comm.parentNode.insertBefore(respond, comm.nextSibling);\n        }\n        const _respond = document.getElementById(\"respond\");\n        window.scrollTo({\n            top: _respond.getBoundingClientRect().top + window.pageYOffset - _respond.clientTop - 100,\n            behavior: \"smooth\"\n        });\n        parent.value = parentId;\n        cancel.style.display = '';\n        cancel.onclick = function (e) {\n            const t = AddComment, temp = document.getElementById('wp-temp-form-div'), respond = document.getElementById(t.respondId);\n            document.getElementById('comment_parent').value = '0';\n            if (temp && respond) {\n                temp.parentNode.insertBefore(respond, temp);\n                temp.remove();\n                //temp.parentNode.removeChild(temp);\n            }\n            this.style.display = 'none';\n            this.onclick = null;\n            return false;\n        };\n        try {\n            document.getElementById('comment').focus();\n        }\n        catch (e) { }\n        return false;\n    },\n};\nexport default AddComment;\n","import { createButterbar } from \"../common/butterbar\";\nimport lazyload from \"../common/lazyload\";\nconst PaginationListener = (e) => {\n    const target = e.target;\n    if (target === document.querySelector(\"#template-pagination a\")) {\n        e.preventDefault();\n        e.stopPropagation();\n        if (target.classList.contains(\"loading\"))\n            return;\n        target.classList.add(\"loading\");\n        target.textContent = \"\";\n        fetch(target.dataset.href + \"&_wpnonce=\" + _iro.nonce, {\n            method: \"POST\"\n        })\n            .then(async (res) => {\n            const data = await res.json();\n            if (res.ok) {\n                document.getElementById(\"template-pagination\").remove();\n                document.querySelector(\".row\").insertAdjacentHTML('beforeend', data);\n                //@ts-ignore\n                lazyload();\n            }\n            else {\n                throw Error(`Error, Status: ${res.status}`);\n            }\n        })\n            .catch(e => {\n            console.error(e);\n            createButterbar(e);\n            target.classList.remove(\"loading\");\n            target.innerHTML = '<i class=\"fa-solid fa-triangle-exclamation\"></i> ERROR ';\n        });\n    }\n};\nexport default function LoadNextPage() {\n    const sections = document.getElementsByTagName(\"section\");\n    let _flag = false;\n    for (let i = 0; i < sections.length; i++) {\n        if (sections[i].classList.contains(\"have-columns\")) {\n            _flag = true;\n            break;\n        }\n    }\n    if (_flag) {\n        document.addEventListener('click', PaginationListener);\n    }\n}\n","import initFooter from \"../app/footer\"\r\n\r\nexport default function prepareEmoji() {\r\n    const emojiPanelButton = document.getElementById('emotion-toggle');\r\n    const emojiPanel = document.querySelector('.emotion-box');\r\n    const header = document.querySelector('.emotion-header');\r\n    const commentTextArea = document.querySelector('.comment-textarea');\r\n\r\n    if (!emojiPanelButton) {\r\n        document.removeEventListener('click', closeEmojiPanel );\r\n        document.removeEventListener('mousemove', moveDrag);\r\n        document.removeEventListener('mouseup', endDrag);\r\n        document.removeEventListener('touchmove', moveDrag);\r\n        document.removeEventListener('touchend', endDrag);\r\n        if (header) {\r\n            header.removeEventListener('touchstart', startDrag);\r\n            header.removeEventListener('mousedown', startDrag);\r\n        }\r\n        return\r\n    }\r\n\r\n    if (emojiPanelButton) {\r\n        emojiPanelButton.addEventListener('click', openEmoji);\r\n    }\r\n\r\n    function openEmoji() {\r\n        if (!emojiPanel) return;\r\n      \r\n        // 判断是否已经拖动过\r\n        const dragged = emojiPanel.getAttribute('dragged');\r\n      \r\n        if (!dragged) {\r\n            const btnRect = emojiPanelButton.getBoundingClientRect();\r\n            const panelWidth = emojiPanel.offsetWidth;\r\n            const panelHeight = emojiPanel.offsetHeight;\r\n\r\n            let leftPos = btnRect.left + window.scrollX + (btnRect.width / 2) - (panelWidth / 2);\r\n            const isFixed = window.getComputedStyle(emojiPanel).position === \"fixed\";\r\n            // let topPos = isFixed ? (btnRect.top - panelHeight) : (btnRect.top - panelHeight + window.scrollY);\r\n\r\n            let topPos = btnRect.bottom;\r\n            // 若下方空间不足，则放在按钮上方\r\n            if (topPos + panelHeight > window.innerHeight) {\r\n                topPos = btnRect.top - panelHeight;\r\n            }\r\n\r\n            emojiPanel.style.left = `${leftPos}px`;\r\n            emojiPanel.style.top = `${topPos}px`;\r\n        }\r\n      \r\n        // 立即呼出\r\n        if (emojiPanel.classList.contains(\"open\")) {\r\n            emojiPanel.classList.toggle('open');\r\n            initFooter(\"check\");\r\n        } else {\r\n            emojiPanel.classList.toggle('open');\r\n            initFooter(\"hide\");\r\n        }\r\n      \r\n        // 初始化拖拽监听器\r\n        if (!emojiPanel.hasAttribute('initialized')) {\r\n            initEmojiPanel();\r\n            emojiPanel.setAttribute('initialized', 'true'); // 标记已初始化\r\n        }\r\n      }\r\n\r\n    function initEmojiPanel() {\r\n        if (!emojiPanel || !header) return;\r\n        \r\n        // 监听鼠标事件\r\n        header.addEventListener('mousedown', startDrag);\r\n        document.addEventListener('mousemove', moveDrag);\r\n        document.addEventListener('mouseup', endDrag);\r\n        \r\n        // 监听触摸事件\r\n        header.addEventListener('touchstart', startDrag, { passive: false });\r\n        document.addEventListener('touchmove', moveDrag, { passive: false });\r\n        document.addEventListener('touchend', endDrag);\r\n        \r\n        // 点击外部关闭面板\r\n        if (emojiPanelButton) {\r\n            document.addEventListener('click', closeEmojiPanel );\r\n        }\r\n    }\r\n\r\n    // 不处于输入框、表情面板、表情开关时，关闭\r\n    function closeEmojiPanel (e) {\r\n        const target = e.target;\r\n        if (\r\n            !emojiPanel.contains(target) && \r\n            !emojiPanelButton.contains(target) &&\r\n            !commentTextArea.contains(target) ) \r\n        {\r\n            if (emojiPanel.classList.contains(\"open\")) {\r\n                emojiPanel.classList.remove('open');\r\n                initFooter(\"check\");\r\n            }\r\n        }\r\n    }\r\n\r\n    let offsetX = 0, offsetY = 0, isDragging = false;\r\n      \r\n    function startDrag(e) {\r\n        isDragging = true;\r\n        const event = (e).touches ? (e).touches[0] : (e);\r\n        offsetX = event.clientX - emojiPanel.offsetLeft;\r\n        offsetY = event.clientY - emojiPanel.offsetTop;\r\n        emojiPanel.style.transition = \"none\"; // 拖拽时禁用动画\r\n    \r\n        if ((e).touches) e.preventDefault();\r\n    }\r\n    \r\n    function moveDrag(e) {\r\n        if (!isDragging) return;\r\n        const event = (e).touches ? (e).touches[0] : (e);\r\n        const left = event.clientX - offsetX;\r\n        const top = event.clientY - offsetY;\r\n        emojiPanel.style.left = `${left}px`;\r\n        emojiPanel.style.top = `${top}px`;\r\n        emojiPanel.setAttribute('dragged', 'true'); // 标记为已拖拽\r\n    \r\n        if ((e).touches) e.preventDefault();\r\n    }\r\n    \r\n    function endDrag() {\r\n        isDragging = false;\r\n        emojiPanel.style.transition = \"\";\r\n    }\r\n\r\n    const row = document.querySelector('.emotion-box>table tr')\r\n    if (!row) return\r\n\r\n    //表情栏切换\r\n    row.addEventListener('click', (e) => {\r\n        if ((e.target).tagName === 'TH') {\r\n            for (const element of row.querySelectorAll('th')) {\r\n                const match = element.className.match(/(\\S+)-bar/);\r\n                if (!match) return;\r\n                /** @type {HTMLElement|null} */\r\n                const container = document.querySelector(`.${match[1]}-container`);\r\n                if (element === e.target) {\r\n                    element.classList.add('on-hover')\r\n                    container.style.display = 'block'\r\n                } else {\r\n                    element.classList.remove('on-hover')\r\n                    container.style.display = 'none'\r\n                }\r\n            }\r\n        }\r\n    })\r\n}\r\n","// 初始化注释功能\r\nexport default function initAnnotations() {\r\n    createAnnotationPopup();\r\n    \r\n    // 检查注释数据\r\n    if (!_iro.have_annotation) return;\r\n    \r\n    if (typeof _iro.page_annotation === 'string') {\r\n        _iro.page_annotation = JSON.parse(_iro.page_annotation);\r\n    }        \r\n    \r\n    if (!_iro.page_annotation || Object.keys(_iro.page_annotation).length === 0) {\r\n        return;\r\n    }\r\n    \r\n    // 查找注释标记\r\n    let annotationMarks = document.querySelectorAll('.iro-term-annotation');\r\n    const processedTerms = new Set(); // 用于跟踪已处理的术语\r\n\r\n    // 为每个术语的第一个注释标记添加点击事件\r\n    annotationMarks.forEach(mark => {\r\n        const term = mark.getAttribute('data-term');\r\n\r\n        // 如果该术语尚未处理\r\n        if (term && !processedTerms.has(term)) {\r\n            mark.addEventListener('click', function(event) {\r\n                event.preventDefault();\r\n                event.stopPropagation();\r\n\r\n                if (_iro.page_annotation && _iro.page_annotation[term]) {\r\n                    let explanation = _iro.page_annotation[term];\r\n                    let popup = document.getElementById('iro-annotation-popup');\r\n\r\n                    popup.querySelector('.term').textContent = term;\r\n                    popup.querySelector('.explanation').textContent = explanation;\r\n\r\n                    let rect = this.getBoundingClientRect();\r\n                    popup.style.top = (window.pageYOffset + rect.bottom + 10) + 'px';\r\n                    popup.style.left = (rect.left - 50) + 'px'; // 调整弹窗位置以更好地适应\r\n                    popup.style.display = 'block';\r\n                }\r\n            });\r\n            processedTerms.add(term); // 将该术语标记为已处理\r\n        }\r\n    });\r\n    \r\n    // 点击其他区域关闭弹窗\r\n    document.addEventListener('click', function(event) {\r\n        let popup = document.getElementById('iro-annotation-popup');\r\n        // 确保 popup 存在并且点击事件的目标不是注释标记或弹窗本身\r\n        if (popup && popup.style.display === 'block' && !event.target.closest('.iro-term-annotation, .iro-annotation-popup')) {\r\n            popup.style.display = 'none';\r\n        }\r\n    });\r\n}\r\n\r\n// 创建注释弹出层\r\nfunction createAnnotationPopup() {\r\n    let popup = document.getElementById('iro-annotation-popup');\r\n    if (popup) return popup;\r\n    \r\n    popup = document.createElement('div');\r\n    popup.id = 'iro-annotation-popup';\r\n    popup.className = 'iro-annotation-popup';\r\n    popup.innerHTML = '<span class=\"close\">×</span><div class=\"term\"></div><div class=\"explanation\"></div>';\r\n    document.body.appendChild(popup);\r\n    \r\n    popup.querySelector('.close').addEventListener('click', function() {\r\n        popup.style.display = 'none';\r\n    });\r\n    \r\n    return popup;\r\n}","/**\r\n * 友情链接提交功能\r\n * \r\n * 处理友情链接提交表单的前端逻辑，包括表单验证、提交和用户反馈\r\n */\r\n\r\n// 多语言翻译\r\nimport initFooter from \"../app/footer\"\r\n\r\nfunction i18n_form() {\r\n    let sakura_links = {\r\n        // 简体中文\r\n        'zh_CN': {\r\n            // 按钮文本\r\n            submitting: '提交中...',\r\n\r\n            // 常规错误提示\r\n            server_error: '服务器错误：',\r\n            connection_error: '连接错误，请稍后重试',\r\n            timeout_error: '请求超时，请稍后重试',\r\n\r\n            // 验证错误提示\r\n            invalid_url: '请输入有效的网站地址',\r\n            invalid_email: '请输入有效的邮箱地址',\r\n            security_error: '安全验证失败，请刷新页面后重试',\r\n\r\n            // 验证码相关\r\n            captcha_load_error: '验证码加载失败，请刷新重试',\r\n            refresh_captcha: '刷新验证码'\r\n        },\r\n\r\n        // 繁体中文\r\n        'zh_TW': {\r\n            // 按钮文本\r\n            submitting: '提交中...',\r\n\r\n            // 常规错误提示\r\n            server_error: '伺服器錯誤：',\r\n            connection_error: '連接錯誤，請稍後重試',\r\n            timeout_error: '請求超時，請稍後重試',\r\n\r\n            // 验证错误提示\r\n            invalid_url: '請輸入有效的網站地址',\r\n            invalid_email: '請輸入有效的郵箱地址',\r\n            security_error: '安全驗證失敗，請刷新頁面後重試',\r\n\r\n            // 验证码相关\r\n            captcha_load_error: '驗證碼加載失敗，請刷新重試',\r\n            refresh_captcha: '刷新驗證碼'\r\n        },\r\n\r\n        // 日语\r\n        'ja': {\r\n            // 按钮文本\r\n            submitting: '送信中...',\r\n\r\n            // 常规错误提示\r\n            server_error: 'サーバーエラー：',\r\n            connection_error: '接続エラー、後でもう一度お試しください',\r\n            timeout_error: 'リクエストがタイムアウトしました、後でもう一度お試しください',\r\n\r\n            // 验证错误提示\r\n            invalid_url: '有効なURLを入力してください',\r\n            invalid_email: '有効なメールアドレスを入力してください',\r\n            security_error: 'セキュリティ検証に失敗しました、ページを更新して再試行してください',\r\n\r\n            // 验证码相关\r\n            captcha_load_error: '認証コードの読み込みに失敗しました、更新して再試行してください',\r\n            refresh_captcha: '認証コードを更新'\r\n        }\r\n    };\r\n\r\n    // 获取页面语言，默认简体中文\r\n    let currentLang = 'zh_CN';\r\n    try {\r\n        // 优先从全局变量获取\r\n        if (_iro.language) {\r\n            currentLang = _iro.language;\r\n        }\r\n        // 从HTML标签获取\r\n        else if (document.documentElement.lang) {\r\n            let htmlLang = document.documentElement.lang;\r\n            currentLang = htmlLang.replace(/-/g, '_');\r\n        }\r\n    } catch (e) {\r\n        // 出错时使用默认语言\r\n    }\r\n\r\n    let validLangs = ['zh_CN', 'zh_TW', 'ja'];\r\n    let lang = validLangs.includes(currentLang) ? currentLang : 'zh_CN';\r\n    let i18n = sakura_links[lang] || sakura_links['zh_CN'];\r\n\r\n    return i18n;\r\n}\r\n\r\n// 全局初始化函数，支持PJAX环境\r\nexport default function initLinkSubmission() {\r\n\r\n    let i18n = i18n_form();\r\n    let submitButton = document.getElementById('openLinkModal');\r\n    let linkModal = document.getElementById('linkModal');\r\n    let closeButton = document.querySelector('.link-modal-close');\r\n    let linkForm = document.getElementById('linkSubmissionForm');\r\n    let captchaImg = document.getElementById('captchaImg');\r\n\r\n    // 如果相关元素不存在\r\n    if (!linkForm || !submitButton || !linkModal || !closeButton || !captchaImg) {\r\n        if (!linkForm) { // 检查是否曾初始化\r\n            document.removeEventListener('pjax:complete', initLinkSubmission);\r\n        }\r\n        return;\r\n    }\r\n\r\n    let patternTitle = document.querySelector('.pattern-header span'); // 检查页面头图\r\n    if (patternTitle) { // 移动按钮到标题后方\r\n        patternTitle.parentNode.insertBefore(submitButton, patternTitle.nextElementSibling);\r\n    }\r\n\r\n    // 初始化行为\r\n    submitButton.addEventListener('click', handleModalOpen); // 呼出\r\n    closeButton.addEventListener('click', handleModalClose); // 关闭\r\n    document.addEventListener('mousedown', handleOutsideClick); // 点击外部关闭\r\n    captchaImg.addEventListener('click', loadCaptcha);\r\n\r\n    // 清理函数\r\n    document.addEventListener('pjax:complete', cleanup);\r\n    function cleanup() {\r\n        // 移除所有事件监听器\r\n        submitButton.removeEventListener('click', handleModalOpen);\r\n        closeButton.removeEventListener('click', handleModalClose);\r\n        document.removeEventListener('mousedown', handleOutsideClick);\r\n        captchaImg.removeEventListener('click', loadCaptcha);\r\n\r\n        linkForm.removeEventListener('submit', handleFormSubmit);\r\n\r\n        enableScroll();\r\n        document.removeEventListener('pjax:complete', cleanup); // 清理自身\r\n    };\r\n\r\n    function handleModalOpen(e) { // 点击展开\r\n        e.preventDefault();\r\n        disableScroll();\r\n        initFooter(\"hide\");\r\n        linkModal.style.display = 'flex';\r\n        loadCaptcha();\r\n    }\r\n\r\n    function handleModalClose() { // 点击关闭\r\n        enableScroll();\r\n        initFooter(\"check\");\r\n        linkModal.style.display = 'none';\r\n    }\r\n\r\n    function handleOutsideClick(e) { // 点击外部关闭\r\n        if (e.target === linkModal) {\r\n            linkModal.style.display = 'none';\r\n            initFooter(\"check\");\r\n            enableScroll();\r\n        }\r\n    }\r\n\r\n    // 滚动行为\r\n    function disableScroll() {\r\n        document.documentElement.style.overflow = 'hidden';\r\n    }\r\n\r\n    function enableScroll() {\r\n        document.documentElement.style.overflowY = 'unset';\r\n    }\r\n\r\n    // 表单提交\r\n    let isSubmitting = false;\r\n    let submissionTimeout = null;\r\n    let submissionLock = false; // 添加提交锁，防止重复提交\r\n\r\n    // 添加表单提交事件监听器\r\n    linkForm.addEventListener('submit', handleFormSubmit);\r\n\r\n    // 定义表单提交处理函数\r\n    async function handleFormSubmit(e) {\r\n        e.preventDefault();\r\n\r\n        // 防止重复提交 - 使用双重锁定机制\r\n        if (isSubmitting || submissionLock) {\r\n            console.log('防止重复提交');\r\n            return;\r\n        }\r\n\r\n        // 设置提交锁\r\n        submissionLock = true;\r\n\r\n        // 延迟执行，确保UI有时间响应\r\n        await new Promise(resolve => setTimeout(resolve, 50));\r\n\r\n        try {\r\n            // 重置状态\r\n            clearTimeout(submissionTimeout);\r\n\r\n            //开始提交\r\n            isSubmitting = true;\r\n\r\n            // 验证表单\r\n            if (!validateForm()) {\r\n                isSubmitting = false;\r\n                submissionLock = false;\r\n                return;\r\n            }\r\n\r\n            // 禁用提交按钮\r\n            let submitButton = linkForm.querySelector('.link-form-submit');\r\n            if (submitButton) {\r\n                submitButton.disabled = true;\r\n            }\r\n\r\n            displayStatus('info', i18n.submitting);\r\n\r\n            // 准备表单数据\r\n            let formData = new FormData(linkForm);\r\n            formData.append('action', 'link_submission');\r\n\r\n            let ajaxUrl = _iro.ajaxurl;\r\n\r\n            // 设置提交超时\r\n            let fetchPromise = fetch(ajaxUrl, {\r\n                method: 'POST',\r\n                body: formData,\r\n                credentials: 'same-origin'\r\n            });\r\n            let timeoutPromise = new Promise((_, reject) => {\r\n                submissionTimeout = setTimeout(() => {\r\n                    reject(new Error(i18n.timeout_error));\r\n                }, 15000);\r\n            });\r\n\r\n            let response = await Promise.race([fetchPromise, timeoutPromise]);\r\n            clearTimeout(submissionTimeout);\r\n\r\n            if (!response.ok) {\r\n                throw new Error(`${i18n.server_error} ${response.status}`);\r\n            }\r\n\r\n            // 捕获响应\r\n            let text = await response.text();\r\n            let data;\r\n            try {\r\n                data = JSON.parse(text);\r\n            } catch (e) {\r\n                throw new Error('服务器返回了无效的JSON响应');\r\n            }\r\n\r\n            // 根据返回结果进行处理\r\n            if (data.success) {\r\n                displayStatus('success', data.data.message);\r\n                linkForm.reset();\r\n            } else {\r\n                displayStatus('error', data.data.message);\r\n                loadCaptcha();\r\n            }\r\n        } catch (error) {\r\n            displayStatus('error', error.message || i18n.connection_error);\r\n            loadCaptcha();\r\n        } finally {\r\n            // 恢复提交状态及按钮，确保最终释放锁\r\n            isSubmitting = false;\r\n            const submitButton = linkForm.querySelector('.link-form-submit');\r\n            if (submitButton) {\r\n                submitButton.disabled = false;\r\n            }\r\n            // 延迟释放提交锁，防止快速连续点击\r\n            setTimeout(() => {\r\n                submissionLock = false;\r\n            }, 1000);\r\n        }\r\n    }\r\n}\r\n\r\n// 验证表单\r\nfunction validateForm() {\r\n    let i18n = i18n_form(); // 确保获取正确的翻译\r\n    let siteName = document.getElementById('siteName');\r\n    let siteUrl = document.getElementById('siteUrl');\r\n    let siteDescription = document.getElementById('siteDescription');\r\n    let siteImage = document.getElementById('siteImage');\r\n    let contactEmail = document.getElementById('contactEmail');\r\n    let captcha = document.getElementById('yzm');\r\n    let timestampInput = document.getElementById('timestamp');\r\n    let idInput = document.getElementById('captchaId');\r\n    let nonceInput = document.querySelector('input[name=\"link_submission_nonce\"]');\r\n\r\n    // 检查是否所有必要元素都存在\r\n    if (!siteName || !siteUrl || !siteDescription || !siteImage || !contactEmail || !captcha || !timestampInput || !idInput || !nonceInput.value) {\r\n        displayStatus('error', i18n.security_error);\r\n        return false;\r\n    }\r\n\r\n    if (!timestampInput.value || !idInput.value) {\r\n        displayStatus('error', i18n.captcha_load_error);\r\n        return false;\r\n    }\r\n\r\n    // 检查URL格式 - 确保以http或https开头\r\n    let siteUrlValue = siteUrl.value.trim();\r\n    if (!/^https?:\\/\\//i.test(siteUrlValue)) {\r\n        siteUrlValue = 'https://' + siteUrlValue;\r\n        siteUrl.value = siteUrlValue;\r\n    }\r\n\r\n    let urlPattern = /^https?:\\/\\/([a-zA-Z0-9-]+\\.)+[a-zA-Z]{2,}(\\/[^\\s]*)?$/;\r\n    if (!urlPattern.test(siteUrlValue)) {\r\n        displayStatus('error', i18n.invalid_url);\r\n        return false;\r\n    }\r\n\r\n    // 检查图片URL格式 - 确保以http或https开头\r\n    let siteImageValue = siteImage.value.trim();\r\n    if (!/^https?:\\/\\//i.test(siteImageValue)) {\r\n        siteImageValue = 'https://' + siteImageValue;\r\n        siteImage.value = siteImageValue;\r\n    }\r\n\r\n    if (!urlPattern.test(siteImageValue)) {\r\n        displayStatus('error', i18n.invalid_url);\r\n        return false;\r\n    }\r\n\r\n    // 检查邮箱格式\r\n    let emailPattern = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n    if (!emailPattern.test(contactEmail.value.trim())) {\r\n        displayStatus('error', i18n.invalid_email);\r\n        return false;\r\n    }\r\n\r\n    // 防止XSS攻击 - 检查输入值是否包含可疑内容\r\n    let xssPattern = /<script[^>]*>[\\s\\S]*?<\\/script>|<[^>]*on\\w+\\s*=|javascript:|data:/i;\r\n    if (\r\n        xssPattern.test(siteName.value) ||\r\n        xssPattern.test(siteDescription.value) ||\r\n        xssPattern.test(siteUrlValue) ||\r\n        xssPattern.test(siteImageValue) ||\r\n        xssPattern.test(contactEmail.value)\r\n    ) {\r\n        displayStatus('error', i18n.security_error);\r\n        return false;\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\n// 加载验证码\r\nfunction loadCaptcha() {\r\n    let i18n = i18n_form(); // 确保获取正确的翻译\r\n    let captchaImg = document.getElementById('captchaImg');\r\n    let captchaInput = document.getElementById('yzm');\r\n    let timestampInput = document.getElementById('timestamp');\r\n    let idInput = document.getElementById('captchaId');\r\n\r\n    // 元素检查\r\n    if (!captchaImg || !captchaInput || !timestampInput || !idInput) {\r\n        return;\r\n    }\r\n\r\n    // 显示加载中状态\r\n    captchaImg.src = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMCIgaGVpZ2h0PSIzMCIgdmlld0JveD0iMCAwIDM4IDM4IiBzdHJva2U9IiM2NjYiPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMSAxKSIgc3Ryb2tlLXdpZHRoPSIyIj48Y2lyY2xlIHN0cm9rZS1vcGFjaXR5PSIuMyIgY3g9IjE4IiBjeT0iMTgiIHI9IjE4Ii8+PHBhdGggZD0iTTM2IDE4YzAtOS45NC04LjA2LTE4LTE4LTE4Ij48YW5pbWF0ZVRyYW5zZm9ybSBhdHRyaWJ1dGVOYW1lPSJ0cmFuc2Zvcm0iIHR5cGU9InJvdGF0ZSIgZnJvbT0iMCAxOCAxOCIgdG89IjM2MCAxOCAxOCIgZHVyPSIxcyIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiLz48L3BhdGg+PC9nPjwvZz48L3N2Zz4=';\r\n    captchaInput.value = '';\r\n\r\n    // 获取验证码API地址\r\n    let endpointUrl = _iro.captcha_endpoint || '';\r\n    if (!endpointUrl) {\r\n        displayStatus('error', i18n.captcha_load_error);\r\n        return;\r\n    }\r\n\r\n    // 添加时间戳防止缓存\r\n    let timestamp = Date.now();\r\n    let endpoint = endpointUrl + (endpointUrl.includes('?') ? '&' : '?') + 't=' + timestamp;\r\n\r\n    fetch(endpoint, {\r\n        method: 'GET',\r\n        credentials: 'same-origin',\r\n        cache: 'no-store',\r\n        headers: {\r\n            'Accept': 'application/json'\r\n        }\r\n    })\r\n        .then(response => {\r\n            if (!response.ok) {\r\n                throw new Error(i18n.captcha_load_error);\r\n            }\r\n            return response.text();\r\n        })\r\n        .then(responseText => {\r\n            try {\r\n                let data = JSON.parse(responseText);\r\n\r\n                // 首先检查API返回的code，不为0表示API自身报错\r\n                if (data.code !== undefined && data.code !== 0) {\r\n                    throw new Error(data.msg || i18n.captcha_load_error);\r\n                }\r\n\r\n                // 检查必要字段是否存在\r\n                if (!data.data || !data.id || !data.time) {\r\n                    throw new Error(i18n.captcha_load_error);\r\n                }\r\n\r\n                // 设置验证码图片\r\n                captchaImg.src = data.data;\r\n                captchaImg.classList.remove('error');\r\n\r\n                // 设置ID和时间戳\r\n                timestampInput.value = String(data.time);\r\n                idInput.value = String(data.id);\r\n            } catch (e) {\r\n                throw new Error(i18n.captcha_load_error);\r\n            }\r\n        })\r\n        .catch(error => {\r\n            captchaImg.classList.add('error');\r\n            captchaImg.src = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MCIgaGVpZ2h0PSI1MCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiNlNzRjM2MiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSIxMCI+PC9jaXJjbGU+PGxpbmUgeDE9IjE1IiB5MT0iOSIgeDI9IjkiIHkyPSIxNSI+PC9saW5lPjxsaW5lIHgxPSI5IiB5MT0iOSIgeDI9IjE1IiB5Mj0iMTUiPjwvbGluZT48L3N2Zz4=';\r\n            displayStatus('error', i18n.captcha_load_error);\r\n            setTimeout(loadCaptcha, 3000);\r\n        });\r\n}\r\n\r\n// 显示状态消息\r\nfunction displayStatus(type, message) {\r\n    let statusElement = document.getElementById('formStatus');\r\n\r\n    if (!statusElement || !message) {\r\n        return;\r\n    }\r\n\r\n    // 防抖：如果已经有计划的状态更新，取消它\r\n    if (window._statusUpdateTimeout) {\r\n        clearTimeout(window._statusUpdateTimeout);\r\n    }\r\n\r\n    // 延迟执行状态更新，避免快速连续调用\r\n    window._statusUpdateTimeout = setTimeout(() => {\r\n        // 清理消息内容，防止XSS\r\n        let sanitizedMessage = message.replace(/[<>\"'&]/g, (c) => {\r\n            return { '<': '&lt;', '>': '&gt;', '\"': '&quot;', \"'\": '&#39;', '&': '&amp;' }[c];\r\n        });\r\n\r\n        // 设置消息类型和内容\r\n        statusElement.className = 'form-status';\r\n        statusElement.classList.add(type === 'success' ? 'success-msg' : 'error-msg');\r\n        statusElement.textContent = sanitizedMessage;\r\n        statusElement.style.display = 'block';\r\n\r\n        // 成功消息自动隐藏\r\n        if (type === 'success') {\r\n            setTimeout(() => {\r\n                if (statusElement) {\r\n                    statusElement.style.display = 'none';\r\n                }\r\n            }, 5000);\r\n        }\r\n    }, 50); // 50ms的防抖延迟\r\n}\r\n\r\n// 页面加载完成时初始化链接提交功能\r\ndocument.addEventListener('DOMContentLoaded', initLinkSubmission);\r\ndocument.addEventListener('pjax:complete', initLinkSubmission);","// 存储原始样式值\r\nlet defaultStyles = {\r\n    profile: {\r\n        display: 'block'\r\n    },\r\n    header: {\r\n        minWidth: '',\r\n        margin: '',\r\n        background: '',\r\n        borderBottom: '1px solid rgba(232, 232, 232, 0.8)',\r\n        padding: '16px'\r\n    },\r\n    username: {\r\n        fontSize: '18px'\r\n    },\r\n    avatar: {\r\n        width: '64px',\r\n        height: '64px'\r\n    }\r\n}\r\n\r\nexport default function init_steamCard() {\r\n    let steamProfiles = document.querySelectorAll('.steam-profile');\r\n    if (!steamProfiles) {\r\n        resize_SteamCard(false);\r\n        return;\r\n    } else {\r\n        applySteamProfileStyles();\r\n        resize_SteamCard(true);\r\n    }\r\n}\r\n\r\n// 应用Steam个人资料样式的函数\r\nfunction applySteamProfileStyles() {\r\n    let steamProfiles = document.querySelectorAll('.steam-profile');\r\n\r\n    steamProfiles.forEach(profile => {\r\n        // 获取所有需要操作的元素\r\n        let gameInfo = profile.querySelector('.steam-game-info');\r\n        let profileHeader = profile.querySelector('.steam-profile-header');\r\n        let username = profile.querySelector('.steam-username');\r\n        \r\n        // 检查是否满足应用样式的条件\r\n        let shouldApplyStyles = profile.offsetWidth > 700 && gameInfo;\r\n        \r\n        if (shouldApplyStyles) {\r\n            // 应用增强样式\r\n            profile.style.display = 'flex';\r\n            \r\n            if (profileHeader) {\r\n                profileHeader.style.minWidth = '50%';\r\n                profileHeader.style.margin = '0 auto';\r\n                profileHeader.style.background = 'none';\r\n                profileHeader.style.borderBottom = 'unset';\r\n                profileHeader.style.padding = '24px';\r\n            }\r\n\r\n            if (username) {\r\n                username.style.fontSize = '30px';\r\n            }\r\n        } else {\r\n            // 重置为默认样式\r\n            profile.style.display = defaultStyles.profile.display;\r\n            \r\n            if (profileHeader) {\r\n                profileHeader.style.minWidth = defaultStyles.header.minWidth;\r\n                profileHeader.style.margin = defaultStyles.header.margin;\r\n                profileHeader.style.background = defaultStyles.header.background;\r\n                profileHeader.style.borderBottom = defaultStyles.header.borderBottom;\r\n                profileHeader.style.padding = defaultStyles.header.padding;\r\n            }\r\n\r\n            if (username) {\r\n                username.style.fontSize = defaultStyles.username.fontSize;\r\n            }\r\n\r\n        }\r\n    });\r\n}\r\n\r\n// 监听窗口大小变化，使用防抖\r\nfunction resize_SteamCard (init = false) {\r\n    let resizeTimer;\r\n    function resizeCard() {\r\n        clearTimeout(resizeTimer);\r\n        resizeTimer = setTimeout(applySteamProfileStyles, 250);\r\n    };\r\n    if (init) {\r\n        window.addEventListener('resize', resizeCard);\r\n    } else {\r\n        window.removeEventListener('resize', resizeCard);\r\n    }\r\n}\r\n    ","import {ifDarkmodeShouldOn} from '../app/darkmode'\r\n\r\nexport default function ghcardTheme(){\r\n    document.addEventListener('darkmode', (event) => { // darkmode.ts informDarkModeChange事件通知\r\n        let turn = event.detail;\r\n        ghcardDark(turn);\r\n    });\r\n    document.addEventListener('pjax:complete',function(){\r\n        checkDark()\r\n    })\r\n    checkDark()\r\n}\r\n\r\nfunction checkDark () {\r\n    const dark = localStorage.getItem(\"dark\")\r\n    if (!dark) {\r\n        if (ifDarkmodeShouldOn() && _iro.darkmode) {\r\n            ghcardDark(true);\r\n        } else {\r\n            ghcardDark(false);\r\n        }\r\n    } else {\r\n        if (dark == '1') {\r\n            ghcardDark(true);\r\n        } else {\r\n            ghcardDark(false);\r\n        }\r\n    }\r\n}\r\n\r\nfunction ghcardDark (turn = false) {\r\n    let cards = document.querySelectorAll('.ghcard');\r\n    if (!cards) return;\r\n    cards.forEach((ghcard) => {\r\n        let card = ghcard.querySelector('img')\r\n        if (!card) return;\r\n        let src = new URL(card.src)\r\n        try{\r\n            if (turn) {\r\n                src.searchParams.set('theme','dark')\r\n                card.src = src.toString()\r\n            } else {\r\n                src.searchParams.delete('theme')\r\n                card.src = src.toString()\r\n            }\r\n        } catch(e){\r\n            // none\r\n        }\r\n    });\r\n}","class Timeline {\r\n    constructor() {\r\n        this.timelineRoot = null;\r\n        this.modalMask = null;\r\n        this.modalContent = null;\r\n        this.modalClose = null;\r\n        this.boundHandleClick = this.handleClick.bind(this);\r\n        this.boundHandleModalClose = this.handleModalClose.bind(this);\r\n        this.boundHandleMaskClick = this.handleMaskClick.bind(this);\r\n\r\n        // 改进语言检测逻辑\r\n        const htmlLang = (document.documentElement.lang || '').toLowerCase();\r\n        // console.log('Detected HTML lang:', htmlLang);\r\n        \r\n        // 支持更多中文变体\r\n        const zhVariants = ['zh-hans', 'zh-cn', 'zh', 'zh-hans-cn'];\r\n        const twVariants = ['zh-hant', 'zh-tw', 'zh-hant-tw'];\r\n        \r\n        // 更新语言匹配逻辑\r\n        if (zhVariants.some(variant => htmlLang.includes(variant))) {\r\n            this.currentLang = 'zh-CN';\r\n        } else if (twVariants.some(variant => htmlLang.includes(variant))) {\r\n            this.currentLang = 'zh-TW';\r\n        } else if (htmlLang.startsWith('ja')) {\r\n            this.currentLang = 'ja';\r\n        } else if (htmlLang.startsWith('fr')) {\r\n            this.currentLang = 'fr';\r\n        } else {\r\n            this.currentLang = 'en';\r\n        }\r\n            \r\n        // console.log('Selected language:', this.currentLang);\r\n    }\r\n\r\n    init() {\r\n        this.timelineRoot = document.getElementById('timeline-root');\r\n        this.categoryRoot = document.getElementById('category-root');\r\n        this.modalMask = document.getElementById('timeline-modal-mask');\r\n        this.modalContent = document.getElementById('timeline-modal-content');\r\n        this.modalClose = document.getElementById('timeline-modal-close');\r\n        this.modalMain = document.querySelector(\"#timeline-modal-mask\")\r\n\r\n        if (!this.timelineRoot || !this.modalMask || !this.modalContent || !this.modalClose) {\r\n            document.documentElement.style.overflowY = 'auto';\r\n            return;\r\n        }\r\n\r\n        this.contentAPI = this.modalContent.dataset.archiveapi;\r\n        this.contents = ''; //内容标志\r\n        (async function(){await timelineInstance.FetchContents()}()) ;\r\n\r\n        this.bindEvents();\r\n    }\r\n\r\n    async FetchContents() {\r\n        try {\r\n            const response = await fetch(this.contentAPI);\r\n            this.contents = await response.json();\r\n        } catch (error) {\r\n            console.warn(\"获取内容失败，重试中...\", error);\r\n            try {\r\n                const response = await fetch(this.contentAPI);\r\n                this.contents = await response.json();\r\n            } catch (retryError) {\r\n                console.error(\"获取内容失败:\", retryError);\r\n                this.contents = {};\r\n            }\r\n        }\r\n    }\r\n\r\n    destroy() {\r\n        if (this.timelineRoot) {\r\n            this.timelineRoot.removeEventListener('click', this.boundHandleClick);\r\n        }\r\n        if (this.categoryRoot) {\r\n            this.categoryRoot.removeEventListener('click', this.boundHandleClick)\r\n        }\r\n        if (this.modalClose) {\r\n            this.modalClose.removeEventListener('click', this.boundHandleModalClose);\r\n        }\r\n        if (this.modalMask) {\r\n            this.modalMask.removeEventListener('click', this.boundHandleMaskClick);\r\n        }\r\n        document.documentElement.style.overflowY = 'auto';\r\n    }\r\n\r\n    bindEvents() {\r\n        this.timelineRoot.addEventListener('click', this.boundHandleClick);\r\n        this.categoryRoot.addEventListener('click', this.boundHandleClick)\r\n        this.modalClose.addEventListener('click', this.boundHandleModalClose);\r\n        this.modalMask.addEventListener('click', this.boundHandleMaskClick);\r\n    }\r\n\r\n    handleClick(e) {\r\n        if (!this.contents) return; // 异步内容请求未完成\r\n        if (e.target.matches('a')) return; // 点击对象为卡片内文章链接\r\n        \r\n        const yearCard = e.target.closest('.timeline-year-card');\r\n        if (yearCard && !e.target.matches('a')) {\r\n            let year = yearCard.dataset.year;\r\n            let yearData = this.filterByYear(year);\r\n            this.renderModal(`${year}`, yearData, 'year');\r\n    \r\n            this.modalMain.showModal();\r\n            document.documentElement.style.overflow = 'hidden';\r\n        }\r\n\r\n        const categoryCard = e.target.closest('.category-card');\r\n        if (categoryCard) {\r\n            const catId = parseInt(categoryCard.dataset.categoryid, 10);\r\n            const categoryData = this.filterByCategory(catId);\r\n            this.renderModal(categoryCard.querySelector('.category-name').innerHTML, categoryData, 'category');\r\n\r\n            this.modalMain.showModal();\r\n            document.documentElement.style.overflow = 'hidden';\r\n        }\r\n    }\r\n\r\n    handleModalClose() {\r\n        this.modalMask.classList.remove('active');\r\n        this.modalMain.close();\r\n        document.documentElement.style.overflowY = 'auto';\r\n    }\r\n\r\n    handleMaskClick(e) {\r\n        if (e.target === this.modalMask) {\r\n            this.modalMask.classList.remove('active');\r\n            this.modalMain.close();\r\n            document.documentElement.style.overflowY = 'auto';\r\n        }\r\n    }\r\n\r\n    filterByYear(year) {\r\n        if (this.contents[year]) {\r\n            return {\r\n                [year]: this.contents[year]\r\n            };\r\n        }\r\n        return {};\r\n    }\r\n\r\n    filterByCategory(catId) {\r\n        const result = {};\r\n        for (const [year, months] of Object.entries(this.contents)) {\r\n        for (const [month, posts] of Object.entries(months)) {\r\n            const matched = posts.filter(post =>\r\n            Array.isArray(post.categories) && post.categories.includes(catId)\r\n            );\r\n            if (matched.length) {\r\n            result[year] = result[year] || {};\r\n            result[year][month] = matched;\r\n            }\r\n        }\r\n        }\r\n        return result;\r\n    }\r\n\r\n    renderModal(label, data, type) {\r\n        let totalStats = {\r\n            posts: 0,\r\n            views: 0,\r\n            words: 0,\r\n            comments: 0\r\n        };\r\n        \r\n        let typeStats = {\r\n            shuoshuo: {\r\n                posts: 0,\r\n                views: 0,\r\n                words: 0,\r\n                comments: 0\r\n            },\r\n            article: {\r\n                posts: 0,\r\n                views: 0,\r\n                words: 0,\r\n                comments: 0\r\n            },\r\n        };\r\n\r\n        // 计算统计数据\r\n        Object.values(data).forEach(monthObj => {\r\n            Object.values(monthObj).forEach(posts => {\r\n                posts.forEach(post => {\r\n                    if (post.meta.type == \"page\") {\r\n                        return;\r\n                    }\r\n\r\n                    const type = post.meta.type || 'article';\r\n                    const views = parseInt(post.meta.views) || 0;\r\n                    const words = parseInt(post.meta.words) || 0;\r\n                    const comments = parseInt(post.comment_count) || 0;\r\n\r\n                    totalStats.posts++;\r\n                    totalStats.views += views;\r\n                    totalStats.words += words;\r\n                    totalStats.comments += comments;\r\n\r\n                    typeStats[type].posts++;\r\n                    typeStats[type].views += views;\r\n                    typeStats[type].words += words;\r\n                    typeStats[type].comments += comments;\r\n                });\r\n            });\r\n        });\r\n        // 多语言翻译对象\r\n        let timelineTranslations = {\r\n            'zh-CN': {\r\n                yearOverview: '年度总览',\r\n                categoryOverview: '分类总览',\r\n                articleCount: '投稿数',\r\n                articles: '文章',\r\n                shuoshuo: '说说',\r\n                readCount: '阅读量',\r\n                times: '次',\r\n                wordCount: '字数',\r\n                characters: '字',\r\n                commentCount: '评论数',\r\n                comments: '条',\r\n                month: '月'\r\n            },\r\n            'zh-TW': {\r\n                yearOverview: '年度總覽',\r\n                categoryOverview: '分類總覽',\r\n                articleCount: '投稿數',\r\n                articles: '文章',\r\n                shuoshuo: '說說',\r\n                readCount: '閱讀量',\r\n                times: '次',\r\n                wordCount: '字數',\r\n                characters: '字',\r\n                commentCount: '評論數',\r\n                comments: '條',\r\n                month: '月'\r\n            },\r\n            'en': {\r\n                yearOverview: 'Year Overview',\r\n                categoryOverview: 'Category Overview',\r\n                articleCount: 'Posts',\r\n                articles: 'Articles',\r\n                shuoshuo: 'Shuoshuo',\r\n                readCount: 'Views',\r\n                times: 'times',\r\n                wordCount: 'Words',\r\n                characters: 'chars',\r\n                commentCount: 'Comments',\r\n                comments: '',\r\n                month: ''\r\n            },\r\n            'ja': {\r\n                yearOverview: '年間概要',\r\n                categoryOverview: 'カテゴリ概要',\r\n                articleCount: '投稿数',\r\n                articles: '記事',\r\n                shuoshuo: 'つぶやき',\r\n                readCount: '閲覧数',\r\n                times: '回',\r\n                wordCount: '文字数',\r\n                characters: '字',\r\n                commentCount: 'コメント数',\r\n                comments: '件',\r\n                month: '月'\r\n            },    \r\n            'fr': {\r\n                yearOverview: 'Aperçu annuel',\r\n                categoryOverview: 'Aperçu des catégories',\r\n                articleCount: 'Articles',\r\n                articles: 'Articles',\r\n                shuoshuo: 'Shuoshuo',\r\n                readCount: 'Vues',\r\n                times: 'fois',\r\n                wordCount: 'Mots',\r\n                characters: 'caractères',\r\n                commentCount: 'Commentaires',\r\n                comments: '',\r\n                month: ''\r\n            }\r\n        };\r\n\r\n        let t = timelineTranslations[this.currentLang];\r\n        let typeTitle = type=='year' ? t.yearOverview : t.categoryOverview;\r\n        let html = `\r\n            <h2 class=\"timeline-modal-title\">${label} ${typeTitle}</h2>\r\n            <div class=\"timeline-modal-stats-grid\">\r\n                <div class=\"timeline-modal-statbox\">\r\n                    <i class=\"stat-icon fas fa-file-alt\"></i>\r\n                    <span class=\"stat-label\">${t.articleCount}</span>\r\n                    <span class=\"stat-value\">${totalStats.posts}</span>                    \r\n                    <div class=\"stat-tooltip\">\r\n                        ${t.articles}：${typeStats.article.posts}<br>\r\n                        ${t.shuoshuo}：${typeStats.shuoshuo.posts}\r\n                    </div>\r\n                </div>\r\n                <div class=\"timeline-modal-statbox\">\r\n                    <i class=\"stat-icon fas fa-eye\"></i>\r\n                    <span class=\"stat-label\">${t.readCount}</span>\r\n                    <span class=\"stat-value\">${toFixNum(totalStats.views)}</span>\r\n                    <div class=\"stat-tooltip\">\r\n                        ${t.articles}：${typeStats.article.views} ${t.times}<br>\r\n                        ${t.shuoshuo}：${toFixNum(typeStats.shuoshuo.views)} ${t.times}\r\n                    </div>\r\n                </div>\r\n                <div class=\"timeline-modal-statbox\">\r\n                    <i class=\"stat-icon fas fa-font\"></i>\r\n                    <span class=\"stat-label\">${t.wordCount}</span>\r\n                    <span class=\"stat-value\">${toFixNum(totalStats.words)}</span>\r\n                    <div class=\"stat-tooltip\">\r\n                        ${t.articles}：${toFixNum(typeStats.article.words)} ${t.characters}<br>\r\n                        ${t.shuoshuo}：${toFixNum(typeStats.shuoshuo.words)} ${t.characters}\r\n                    </div>\r\n                </div>\r\n                <div class=\"timeline-modal-statbox\">\r\n                    <i class=\"stat-icon fas fa-comments\"></i>\r\n                    <span class=\"stat-label\">${t.commentCount}</span>\r\n                    <span class=\"stat-value\">${totalStats.comments}</span>                    \r\n                    <div class=\"stat-tooltip\">\r\n                        ${t.articles}：${typeStats.article.comments} ${t.comments}<br>\r\n                        ${t.shuoshuo}：${typeStats.shuoshuo.comments} ${t.comments}\r\n                    </div>\r\n                </div>\r\n            </div>`;\r\n        \r\n        const monthsDesc = Object.entries(data)\r\n            .sort((a, b) => parseInt(b[0], 10) - parseInt(a[0], 10));\r\n\r\n        for (const [year, monthsObj] of monthsDesc) {\r\n            const months = Object.entries(monthsObj)\r\n                .sort((a, b) => parseInt(b[0], 10) - parseInt(a[0], 10));\r\n            \r\n            for (const [month, posts] of months) {\r\n                let monthTitle = type=='year' ? `${month}${t.month}` : `${year}-${month}${t.month}`\r\n                html += `\r\n                <div class=\"timeline-modal-month-group\">\r\n                    <h3 class=\"timeline-modal-month-title\">${monthTitle}</h3>\r\n                    <div class=\"timeline-modal-post-list\">\r\n                `;\r\n\r\n                posts\r\n                    .slice()\r\n                    .sort((a, b) => new Date(b.post_date) - new Date(a.post_date))\r\n                    .forEach(post => {\r\n                        if (post.meta.type === 'page') return; // 页面不列出\r\n                        const date = new Date(post.post_date);\r\n                        const formattedDate = `${date.getMonth() + 1}-${date.getDate()}`;\r\n                        const postType = post.meta.type === 'shuoshuo' ? ` [${t.shuoshuo}]` : '';\r\n                        html += `\r\n                            <a href=\"${post.link}\" class=\"timeline-modal-post-item\">\r\n                                <span class=\"timeline-modal-post-title\">${post.post_title}${postType}</span>\r\n                                <span class=\"timeline-modal-post-date\">${formattedDate}</span>\r\n                            </a>`;\r\n                    });\r\n                html += `</div></div>`;\r\n            }\r\n        }\r\n\r\n        this.modalContent.innerHTML = html;\r\n        this.modalMask.classList.add('active');\r\n    }\r\n}\r\n\r\n// 创建单例实例\r\nlet timelineInstance = null;\r\n\r\nexport default function initTimeArchive() {\r\n    if (timelineInstance) {\r\n        timelineInstance.destroy();\r\n        timelineInstance = null;\r\n    }\r\n    timelineInstance = new Timeline();\r\n    timelineInstance.init();\r\n}\r\n\r\nfunction toFixNum(num) {\r\n    if (num >= 1000000) {\r\n      return (num / 1000000).toFixed(2) + 'm';\r\n    } else {\r\n      return num;\r\n    }\r\n  }\r\n","let visibilityHandler = null;\r\nlet scrollHandler = null;\r\nlet videoClickHandler = null;\r\nlet appClickHandler = null;\r\nlet appObserverInstance = null;\r\nlet imgObserverInstance = null;\r\nlet videoContainer = null;\r\nlet isInitialized = false;\r\nlet isAdmin = null;\r\nlet app = null;\r\n\r\nexport default function bili_fav_init () {\r\n    function init(){\r\n        app = document.getElementById(\"bilibili-favlist-app\");\r\n        isAdmin = _iro.is_admin;\r\n        cleanup();\r\n        if (app) {\r\n            initBilibiliFavList();\r\n        }\r\n    }\r\n    document.addEventListener(\"pjax:complete\",init);\r\n    init();\r\n}\r\n\r\nfunction cleanup () {\r\n    if (visibilityHandler) {\r\n        document.removeEventListener(\"visibilitychange\", visibilityHandler);\r\n        visibilityHandler = null;\r\n    }\r\n    if (scrollHandler) {\r\n        window.removeEventListener(\"scroll\", scrollHandler);\r\n        scrollHandler = null;\r\n    }\r\n    if (videoClickHandler) {\r\n        document.removeEventListener(\"click\", videoClickHandler);\r\n        videoClickHandler = null;\r\n    }\r\n    const app = document.getElementById(\"bilibili-favlist-app\");\r\n    if (app) {\r\n        if (appClickHandler) {\r\n            app.removeEventListener(\"click\", appClickHandler);\r\n            appClickHandler = null;\r\n        }\r\n    }\r\n    if (appObserverInstance) {\r\n        appObserverInstance.disconnect();\r\n        appObserverInstance = null;\r\n    }\r\n    if (imgObserverInstance) {\r\n        imgObserverInstance.disconnect();\r\n        imgObserverInstance = null;\r\n    }\r\n    isInitialized = false;\r\n};\r\n\r\n// Bilibili收藏夹应用初始化函数\r\nasync function initBilibiliFavList() {\r\n    if (isInitialized) {\r\n        return;\r\n    }\r\n    cleanup();\r\n\r\n    isInitialized = true;\r\n\r\n    try {\r\n        const restApiUrl = _iro.iro_api;\r\n        const wpnonce = _iro.nonce;\r\n\r\n        if (!restApiUrl) {\r\n            throw new Error(\"初始化失败：REST API路径不可用\");\r\n        }\r\n\r\n        const state = {\r\n            folders: [],\r\n            currentFolder: null,\r\n            loading: true,\r\n            pageSize: 12,\r\n            currentItems: [],\r\n            currentPage: 1,\r\n            totalPages: 0,\r\n            error: null,\r\n            lastDataUpdate: 0,\r\n            fromCache: false,\r\n            cacheExpiresIn: 0,\r\n            cacheAge: 0,\r\n            cache: new Map(),\r\n        };\r\n\r\n        const cache = {\r\n            getKey: (folderId, page) => `folder_${folderId}_page_${page}`,\r\n            set: (folderId, page, data) => {\r\n                const key = cache.getKey(folderId, page);\r\n                state.cache.set(key, {\r\n                    timestamp: Date.now(),\r\n                    data: data,\r\n                });\r\n                try {\r\n                    const lsKey = `bilibili_favlist_${folderId}_${page}`;\r\n                    localStorage.setItem(\r\n                        lsKey,\r\n                        JSON.stringify({\r\n                            timestamp: Date.now(),\r\n                            data: data,\r\n                        })\r\n                    );\r\n                } catch (e) {\r\n                }\r\n            },\r\n            get: (folderId, page) => {\r\n                const key = cache.getKey(folderId, page);\r\n                let item = state.cache.get(key);\r\n                if (!item) {\r\n                    try {\r\n                        const lsKey = `bilibili_favlist_${folderId}_${page}`;\r\n                        const savedData = localStorage.getItem(lsKey);\r\n                        if (savedData) {\r\n                            const parsed = JSON.parse(savedData);\r\n                            if (\r\n                                parsed &&\r\n                                parsed.timestamp &&\r\n                                Date.now() - parsed.timestamp <\r\n                                    12 * 60 * 60 * 1000\r\n                            ) {\r\n                                state.cache.set(key, parsed);\r\n                                item = parsed;\r\n                            } else {\r\n                                localStorage.removeItem(lsKey);\r\n                            }\r\n                        }\r\n                    } catch (e) {}\r\n                }\r\n                return item;\r\n            },\r\n            isValid: (cachedItem) => {\r\n                if (!cachedItem) return false;\r\n                return Date.now() - cachedItem.timestamp < 12 * 60 * 60 * 1000;\r\n            },\r\n        };\r\n\r\n        async function initApp() {\r\n            try {\r\n                await fetchAllFolders();\r\n                renderApp();\r\n                bindEvents(); // Bind events after rendering\r\n                setupScrollEffects(); // Setup effects after rendering\r\n                imgObserverInstance = setupImageLazyLoading(); // Setup lazy loading and store observer\r\n                setupVideoModal(); // Setup modal structure\r\n                setupVideoItemsClickEvent(); // Setup click listener for video items\r\n                setupScrollAnimations(); // Setup scroll animations\r\n            } catch (error) {\r\n                let errorMsg = error.message || \"未知错误\";\r\n                showError(`加载收藏夹失败: ${errorMsg}<br>请刷新页面重试`);\r\n            }\r\n        }\r\n\r\n        async function fetchAllFolders(forceRefresh = false) {\r\n            state.loading = true;\r\n            renderApp();\r\n\r\n            if (!forceRefresh) {\r\n                try {\r\n                    const savedData = localStorage.getItem(\"bilibili_favlist_folders\");\r\n                    if (savedData) {\r\n                        const parsed = JSON.parse(savedData);\r\n                        if (\r\n                            parsed &&\r\n                            parsed.timestamp &&\r\n                            Date.now() - parsed.timestamp < 12 * 60 * 60 * 1000\r\n                        ) {\r\n                            state.folders = parsed.folders;\r\n                            if (state.folders?.length) {\r\n                                state.currentFolder =\r\n                                    state.currentFolder || state.folders[0].id;\r\n                                await fetchFolderItems(\r\n                                    state.currentFolder,\r\n                                    1,\r\n                                    false\r\n                                );\r\n                                return;\r\n                            }\r\n                        } else {\r\n                            localStorage.removeItem(\"bilibili_favlist_folders\"); // Remove expired\r\n                        }\r\n                    }\r\n                } catch (e) {}\r\n            }\r\n\r\n            const endpoint = `${restApiUrl}/favlist/bilibili/folders`;\r\n            try {\r\n                let url = `${endpoint}?_wpnonce=${wpnonce}`;\r\n                if (forceRefresh) {\r\n                    url += `&_t=${Date.now()}`;\r\n                }\r\n\r\n                const response = await fetch(url, {\r\n                    headers: {\r\n                        \"Cache-Control\": forceRefresh\r\n                            ? \"no-cache, no-store, must-revalidate\"\r\n                            : \"max-age=43200\",\r\n                        Pragma: forceRefresh ? \"no-cache\" : undefined,\r\n                    },\r\n                });\r\n\r\n                if (!response.ok) throw new Error(`网络请求失败 (${response.status})`);\r\n\r\n                const data = await response.json();\r\n                if (data.code !== 0) throw new Error(data.message || \"获取收藏夹列表失败\");\r\n\r\n                state.folders = data.data.list || [];\r\n                if (state.folders?.length) {\r\n                    try {\r\n                        localStorage.setItem(\"bilibili_favlist_folders\",JSON.stringify({timestamp: Date.now(),folders: state.folders,}));\r\n                    } catch (e) {}\r\n                    state.currentFolder = state.folders[0].id;\r\n                    await fetchFolderItems(state.currentFolder,1,forceRefresh);\r\n                } else {\r\n                    state.loading = false;\r\n                    state.currentItems = [];\r\n                    state.totalPages = 0;\r\n                    renderApp();\r\n                }\r\n            } catch (error) {\r\n                showError(\"加载收藏夹列表失败，请刷新页面重试\");\r\n                state.loading = false;\r\n                renderApp();\r\n            }\r\n        }\r\n\r\n        async function fetchFolderItems(folderId,page = 1,forceRefresh = false) {\r\n            state.loading = true;\r\n            state.error = null;\r\n            state.currentPage = page;\r\n            state.currentFolder = folderId;\r\n            renderApp();\r\n\r\n            if (!forceRefresh) {\r\n                const cachedData = cache.get(folderId, page);\r\n                if (cache.isValid(cachedData)) {\r\n                    const folderData = cachedData.data;\r\n                    state.currentItems = folderData.medias || [];\r\n                    state.totalPages = Math.ceil(\r\n                        (folderData.info?.media_count || 0) / state.pageSize\r\n                    );\r\n                    state.fromCache = true;\r\n                    state.cacheAge = Math.floor(\r\n                        (Date.now() - cachedData.timestamp) / 1000\r\n                    );\r\n                    state.loading = false;\r\n                    renderApp(true);\r\n                    return;\r\n                }\r\n            }\r\n            await fetchFolderItemsFromNetwork(folderId, page, forceRefresh);\r\n        }\r\n\r\n        async function fetchFolderItemsFromNetwork(folderId,page = 1,forceRefresh = false) {\r\n            const endpoint = `${restApiUrl}/favlist/bilibili`;\r\n            try {\r\n                let url = `${endpoint}?folder_id=${folderId}&page=${page}&_wpnonce=${wpnonce}`;\r\n                if (forceRefresh) {\r\n                    url += `&_t=${Date.now()}`;\r\n                }\r\n\r\n                const response = await fetch(url, {\r\n                    headers: {\r\n                        \"Cache-Control\": forceRefresh\r\n                            ? \"no-cache, no-store, must-revalidate\"\r\n                            : \"max-age=43200\",\r\n                        Pragma: forceRefresh ? \"no-cache\" : undefined,\r\n                    },\r\n                });\r\n\r\n                if (!response.ok)\r\n                    throw new Error(`网络请求失败 (${response.status})`);\r\n\r\n                const data = await response.json();\r\n                if (data.code !== 0)\r\n                    throw new Error(data.message || \"获取收藏内容失败\");\r\n\r\n                const folderData = data.data;\r\n                cache.set(folderId, page, folderData); // Update cache\r\n\r\n                state.currentItems = folderData.medias || [];\r\n                state.totalPages = Math.ceil(\r\n                    (folderData.info?.media_count || 0) / state.pageSize\r\n                );\r\n                state.fromCache = data.cache_info?.from_cache || false;\r\n                state.cacheExpiresIn = data.cache_info?.expires_in || 0;\r\n                state.lastDataUpdate = Date.now();\r\n            } catch (error) {\r\n                showError(`加载收藏内容失败: ${error.message}. 请重试`);\r\n                state.currentItems = [];\r\n                state.totalPages = 0;\r\n            } finally {\r\n                state.loading = false;\r\n                renderApp(true);\r\n            }\r\n        }\r\n\r\n        function showError(message) {\r\n            state.error = message;\r\n            state.loading = false;\r\n        }\r\n\r\n        function renderApp(isUpdate = false) {\r\n            const EXIT_ANIMATION_DURATION = 400; // 基础退出动画时间 (ms)\r\n            const EXIT_STAGGER_DELAY = 50; // 每个卡片退出的交错延迟 (ms)\r\n            const ENTER_STAGGER_DELAY = 30; // 每个卡片进入的交错延迟 (ms) - 更短\r\n            const folderSelectorHtml =\r\n                state.folders.length > 0 ? renderFolderSelector() : \"\";\r\n            let contentHtml = \"\";\r\n\r\n            if (state.error) {\r\n                contentHtml = `\r\n                    <div class=\"fav-section\">\r\n                    <div class=\"fav-content\">\r\n                    <div class=\"fav-empty\">\r\n                    <p>${state.error}</p>\r\n                    <button class=\"page-btn retry-btn\">重试</button>\r\n                    </div>\r\n                    </div>\r\n                    </div>\r\n                `;\r\n            } else if (state.loading && !state.currentItems.length) {\r\n                contentHtml = renderLoadingSkeleton();\r\n            } else if (!state.folders.length && !state.loading) {\r\n                contentHtml = `\r\n                    <div class=\"fav-section\">\r\n                    <div class=\"fav-content\">\r\n                    <div class=\"fav-empty\">\r\n                    <p>没有找到收藏夹或UID配置错误。</p>\r\n                        <button class=\"page-btn retry-btn\">重试</button>\r\n                    </div>\r\n                    </div>\r\n                    </div>\r\n                `;\r\n            } else {\r\n                contentHtml = renderCurrentFolder(); // renderCurrentFolder 现在只返回内容部分的 HTML\r\n            }\r\n\r\n            const existingContent = app.querySelector(\".fav-section\");\r\n            const wasSkeleton =\r\n                existingContent &&\r\n                existingContent.querySelector(\".fav-item-skeleton\");\r\n            // 仅在成功更新内容且之前不是骨架屏时应用动画\r\n            const needsAnimation =\r\n                isUpdate &&\r\n                existingContent &&\r\n                !wasSkeleton &&\r\n                !state.loading &&\r\n                !state.error;\r\n\r\n            const renderNewContent = () => {\r\n                app.innerHTML = folderSelectorHtml + contentHtml; // 渲染包括 tabs 和新内容\r\n\r\n                // Re-bind events and apply effects to new content\r\n                bindAppContainerEvents();\r\n                if (\r\n                    !state.loading &&\r\n                    !state.error &&\r\n                    state.currentItems.length > 0\r\n                ) {\r\n                    const newItems = app.querySelectorAll(\".fav-item\");\r\n                    newItems.forEach((item, index) => {\r\n                        // 为新项目添加入场动画和交错\r\n                        item.classList.add(\"fav-item-enter\");\r\n                        // 添加入场交错\r\n                        item.style.transitionDelay = `${\r\n                            index * ENTER_STAGGER_DELAY\r\n                        }ms`;\r\n                        requestAnimationFrame(() => {\r\n                            // 触发 CSS transition\r\n                            if (item && item.parentNode) {\r\n                                item.classList.remove(\"fav-item-enter\");\r\n                            }\r\n                        });\r\n                    });\r\n                    // 重新设置懒加载和滚动动画\r\n                    if (imgObserverInstance) imgObserverInstance.disconnect();\r\n                    imgObserverInstance = setupImageLazyLoading();\r\n                    setupScrollAnimations(); // 重新设置滚动动画监听\r\n                } else {\r\n                    // 如果是骨架屏或错误状态，可能不需要特定的进入动画或效果\r\n                    if (imgObserverInstance) imgObserverInstance.disconnect(); // 确保旧的观察器被移除\r\n                    imgObserverInstance = null;\r\n                    if (scrollHandler)\r\n                        window.removeEventListener(\"scroll\", scrollHandler); // 移除旧的滚动监听\r\n                    scrollHandler = null;\r\n                }\r\n            };\r\n\r\n            if (needsAnimation) {\r\n                const itemsToExit =\r\n                    existingContent.querySelectorAll(\".fav-item\");\r\n                if (itemsToExit.length > 0) {\r\n                    // 计算总退出时间 (最后一个元素完成动画的时间点)\r\n                    const totalExitDuration =\r\n                        EXIT_ANIMATION_DURATION +\r\n                        (itemsToExit.length - 1) * EXIT_STAGGER_DELAY;\r\n\r\n                    // 应用交错退出动画\r\n                    itemsToExit.forEach((item, index) => {\r\n                        // 使用 requestAnimationFrame 确保类添加和延迟设置在同一帧或后续帧\r\n                        requestAnimationFrame(() => {\r\n                            // 确保元素仍然存在\r\n                            if (item && item.parentNode) {\r\n                                item.style.transitionDelay = `${\r\n                                    index * EXIT_STAGGER_DELAY\r\n                                }ms`;\r\n                                item.classList.add(\"fav-item-exit\");\r\n                                // 在动画结束后移除元素上的延迟，以防干扰后续操作\r\n                                setTimeout(() => {\r\n                                    if (item && item.parentNode) {\r\n                                        // 再次检查\r\n                                        item.style.transitionDelay = \"\";\r\n                                    }\r\n                                }, EXIT_ANIMATION_DURATION + index * EXIT_STAGGER_DELAY);\r\n                            }\r\n                        });\r\n                    });\r\n\r\n                    // 稍微提前调用 renderNewContent，让进入动画开始时，退出动画接近尾声\r\n                    // 例如，在最后一个元素开始退出动画后不久，或者总时间的 80-90% 处\r\n                    const waitTimeForNewContent = Math.max(\r\n                        EXIT_ANIMATION_DURATION,\r\n                        totalExitDuration - EXIT_STAGGER_DELAY * 2\r\n                    ); // 保证至少等待基础动画时间，并提前一点\r\n\r\n                    // 等待计算出的时间后渲染新内容\r\n                    setTimeout(renderNewContent, waitTimeForNewContent);\r\n                } else {\r\n                    // 如果没有旧项目（例如从空状态更新），直接渲染\r\n                    renderNewContent();\r\n                }\r\n            } else {\r\n                // 初始加载、加载骨架屏、显示错误、从错误重试或从骨架屏更新时，直接渲染\r\n                renderNewContent();\r\n            }\r\n        }\r\n        function renderLoadingSkeleton() {\r\n            let skeletonHtml =\r\n                '<div class=\"fav-section\"><div class=\"fav-content\"><div class=\"fav-grid\">';\r\n            for (let i = 0; i < state.pageSize; i++) {\r\n                skeletonHtml += `\r\n                    <div class=\"fav-item fav-item-skeleton\">\r\n                    <div class=\"fav-item-content-wrapper\">\r\n                    <div class=\"fav-item-thumb\">\r\n                    <div class=\"fav-item-thumb-placeholder\"></div>\r\n                    </div>\r\n                    <div class=\"fav-item-desc-wrapper\">\r\n                    <div class=\"fav-item-desc\"></div>\r\n                    <div class=\"fav-item-desc\"></div>\r\n                    </div>\r\n                    </div>\r\n                    </div>\r\n                `;\r\n            }\r\n            skeletonHtml += \"</div></div></div>\";\r\n            return skeletonHtml;\r\n        }\r\n\r\n        function renderFolderSelector() {\r\n            let refreshButtonHtml = \"\";\r\n            // Only add refresh button if the user is an admin\r\n            if (isAdmin) {\r\n                refreshButtonHtml = `\r\n                    <div class=\"fav-tab refresh-btn\" title=\"强制刷新数据 (仅管理员可见)\">\r\n                    <svg viewBox=\"0 0 24 24\" width=\"16\" height=\"16\" stroke=\"currentColor\" stroke-width=\"2\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\r\n                    <path d=\"M3 2v6h6\"></path>\r\n                    <path d=\"M21 12A9 9 0 0 0 6 5.3L3 8\"></path>\r\n                    <path d=\"M21 22v-6h-6\"></path>\r\n                    <path d=\"M3 12a9 9 0 0 0 15 6.7l3-2.7\"></path>\r\n                    </svg>\r\n                    <span class=\"refresh-text\">刷新</span>\r\n                    </div>\r\n                `;\r\n            }\r\n\r\n            return `\r\n                <div class=\"fav-tabs\">\r\n                ${state.folders\r\n                    .map(\r\n                        (folder) => `\r\n                            <div class=\"fav-tab ${folder.id === state.currentFolder ? \"active\" : \"\"}\"\r\n                            data-folder-id=\"${folder.id}\">\r\n                            ${folder.title}\r\n                            <span class=\"fav-tab-count\">${folder.media_count}</span>\r\n                            </div>\r\n                        `\r\n                    )\r\n                    .join(\"\")}\r\n                ${refreshButtonHtml}\r\n                </div>\r\n            `;\r\n        }\r\n\r\n        function renderCurrentFolder() {\r\n            const currentFolder = state.folders.find(\r\n                (folder) => folder.id === state.currentFolder\r\n            );\r\n\r\n            let contentHtml = \"\";\r\n            if (!state.currentItems.length && !state.loading) {\r\n                contentHtml = `<div class=\"fav-empty\"><p>该收藏夹暂无内容</p></div>`;\r\n            } else if (state.currentItems.length) {\r\n                contentHtml = `\r\n                    <div class=\"fav-grid\">\r\n                    ${state.currentItems.map((item) => renderFavItem(item)).join(\"\")}\r\n                    </div>\r\n                    ${renderPagination()}\r\n                `;\r\n            }\r\n\r\n            return `\r\n                <div class=\"fav-section\">\r\n                <div class=\"fav-content\">\r\n                ${contentHtml}\r\n                </div>\r\n                </div>\r\n            `;\r\n        }\r\n\r\n        function renderFavItem(item) {\r\n            // ... existing renderFavItem code ...\r\n            let bvid = item.bvid || \"\";\r\n            // Ensure cover uses HTTPS and handle potential missing cover\r\n            let cover = item.cover\r\n                ? item.cover.replace(/^http:/, \"https:\")\r\n                : \"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\"; // Placeholder for missing cover\r\n\r\n            return `\r\n                <div class=\"fav-item\" data-bvid=\"${bvid}\" data-title=\"${item.title}\" data-up=\"${\r\n                                item.upper?.name || \"未知\"\r\n                            }\" tabindex=\"0\" role=\"button\" aria-label=\"播放视频: ${item.title}\">\r\n                <div class=\"fav-item-content-wrapper\">\r\n                <div class=\"fav-item-thumb\">\r\n                <div class=\"fav-item-thumb-placeholder\">\r\n                <!-- 移除 spinner -->\r\n                </div>\r\n                <img data-src=\"${cover}\" class=\"fav-thumb-img\" src=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\" referrerpolicy=\"no-referrer\" alt=\"${\r\n                                item.title\r\n                            }\">\r\n                <div class=\"fav-item-title-area\">\r\n                <h3 class=\"fav-item-title\" title=\"${item.title}\">${item.title}</h3>\r\n                </div>\r\n                <div class=\"fav-item-up\">\r\n                <span class=\"up-name\">UP: ${item.upper?.name || \"未知\"}</span>\r\n                </div>\r\n                <div class=\"fav-item-play-btn\">\r\n                <svg viewBox=\"0 0 24 24\" width=\"36\" height=\"36\" stroke=\"currentColor\" stroke-width=\"2\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><polygon points=\"10 8 16 12 10 16 10 8\" fill=\"currentColor\"></polygon></svg>\r\n                </div>\r\n                </div>\r\n                <div class=\"fav-item-desc-wrapper\">\r\n                <div class=\"fav-item-desc\" title=\"${item.intro || \"\"}\">${\r\n                                item.intro || \"暂无简介\"\r\n                            }</div>\r\n                </div>\r\n                </div>\r\n                </div>\r\n            `;\r\n        }\r\n\r\n        function renderPagination() {\r\n            // ... existing renderPagination code ...\r\n            if (state.totalPages <= 1) return \"\";\r\n\r\n            let paginationHtml = '<div class=\"fav-pagination\">';\r\n            const currentPage = state.currentPage;\r\n            const totalPages = state.totalPages;\r\n\r\n            // Prev Button\r\n            paginationHtml += `<button class=\"page-btn prev-btn\" ${\r\n                currentPage <= 1 ? \"disabled\" : \"\"\r\n            } data-page=\"${currentPage - 1}\">上一页</button>`;\r\n\r\n            // Page numbers logic (simplified example)\r\n            const maxPagesToShow = 5;\r\n            let startPage = Math.max(\r\n                1,\r\n                currentPage - Math.floor(maxPagesToShow / 2)\r\n            );\r\n            let endPage = Math.min(totalPages, startPage + maxPagesToShow - 1);\r\n\r\n            if (endPage - startPage + 1 < maxPagesToShow) {\r\n                startPage = Math.max(1, endPage - maxPagesToShow + 1);\r\n            }\r\n\r\n            if (startPage > 1) {\r\n                paginationHtml += `<button class=\"page-btn page-num\" data-page=\"1\">1</button>`;\r\n                if (startPage > 2)\r\n                    paginationHtml += `<button class=\"page-btn page-ellipsis\" disabled>...</button>`;\r\n            }\r\n\r\n            for (let i = startPage; i <= endPage; i++) {\r\n                paginationHtml += `<button class=\"page-btn page-num ${\r\n                    i === currentPage ? \"active\" : \"\"\r\n                }\" data-page=\"${i}\">${i}</button>`;\r\n            }\r\n\r\n            if (endPage < totalPages) {\r\n                if (endPage < totalPages - 1)\r\n                    paginationHtml += `<button class=\"page-btn page-ellipsis\" disabled>...</button>`;\r\n                paginationHtml += `<button class=\"page-btn page-num\" data-page=\"${totalPages}\">${totalPages}</button>`;\r\n            }\r\n\r\n            // Next Button\r\n            paginationHtml += `<button class=\"page-btn next-btn\" ${\r\n                currentPage >= totalPages ? \"disabled\" : \"\"\r\n            } data-page=\"${currentPage + 1}\">下一页</button>`;\r\n\r\n            paginationHtml += \"</div>\";\r\n            return paginationHtml;\r\n        }\r\n\r\n        function bindAppContainerEvents() {\r\n            if (appClickHandler)\r\n                app.removeEventListener(\"click\", appClickHandler);\r\n\r\n            appClickHandler = async function (e) {\r\n                const target = e.target;\r\n                const REFRESH_COOLDOWN = 60 * 1000;\r\n\r\n                const refreshBtn = target.closest(\".refresh-btn\");\r\n                if (\r\n                    isAdmin &&\r\n                    refreshBtn &&\r\n                    !refreshBtn.classList.contains(\"refreshing\")\r\n                ) {\r\n                    const lastRefreshTs = parseInt(localStorage.getItem(\"bilibili_last_refresh_ts\") || \"0\",10);\r\n                    const now = Date.now();\r\n                    const remainingTime =\r\n                        REFRESH_COOLDOWN - (now - lastRefreshTs);\r\n                    const refreshTextSpan =\r\n                        refreshBtn.querySelector(\".refresh-text\");\r\n\r\n                    if (remainingTime > 0) {\r\n                        if (refreshTextSpan) {\r\n                            const originalText = refreshTextSpan.textContent;\r\n                            refreshTextSpan.textContent = `请稍后 (${Math.ceil(\r\n                                remainingTime / 1000\r\n                            )}s)`;\r\n                            setTimeout(() => {\r\n                                const currentBtn =app.querySelector(\".refresh-btn\");\r\n                                const currentTextSpan =currentBtn?.querySelector(\".refresh-text\");\r\n                                if (\r\n                                    currentTextSpan &&\r\n                                    currentTextSpan.textContent.startsWith(\r\n                                        \"请稍后\"\r\n                                    )\r\n                                ) {\r\n                                    currentTextSpan.textContent = \"刷新\";\r\n                                }\r\n                            }, remainingTime);\r\n                        }\r\n                        return;\r\n                    }\r\n\r\n                    localStorage.setItem(\r\n                        \"bilibili_last_refresh_ts\",\r\n                        now.toString()\r\n                    );\r\n                    refreshBtn.classList.add(\"refreshing\");\r\n                    if (refreshTextSpan)\r\n                        refreshTextSpan.textContent = \"刷新中...\";\r\n\r\n                    try {\r\n                        localStorage.removeItem(\"bilibili_favlist_folders\");\r\n                        if (state.currentFolder) {\r\n                            for (let i = 1; i <= state.totalPages; i++) {\r\n                                localStorage.removeItem(\r\n                                    `bilibili_favlist_${state.currentFolder}_${i}`\r\n                                );\r\n                                state.cache.delete(\r\n                                    cache.getKey(state.currentFolder, i)\r\n                                );\r\n                            }\r\n                            localStorage.removeItem(\r\n                                `bilibili_favlist_${state.currentFolder}_${state.currentPage}`\r\n                            );\r\n                            state.cache.delete(\r\n                                cache.getKey(\r\n                                    state.currentFolder,\r\n                                    state.currentPage\r\n                                )\r\n                            );\r\n                        }\r\n                        state.cache = new Map();\r\n\r\n                        await fetchAllFolders(true);\r\n                    } catch (error) {\r\n                        showError(\"刷新失败，请稍后重试\");\r\n                        renderApp();\r\n                    } finally {\r\n                        const currentRefreshBtn =\r\n                            app.querySelector(\".refresh-btn\");\r\n                        if (currentRefreshBtn) {\r\n                            currentRefreshBtn.classList.remove(\"refreshing\");\r\n                            const currentTextSpan =\r\n                                currentRefreshBtn.querySelector(\r\n                                    \".refresh-text\"\r\n                                );\r\n                            if (currentTextSpan)\r\n                                currentTextSpan.textContent = \"刷新\";\r\n                        }\r\n                    }\r\n                    return;\r\n                }\r\n\r\n                const tabEl = target.closest(\".fav-tab:not(.refresh-btn)\");\r\n                if (tabEl) {\r\n                    const folderId = parseInt(tabEl.dataset.folderId, 10);\r\n                    if (folderId !== state.currentFolder && !state.loading) {\r\n                        await fetchFolderItems(folderId, 1);\r\n                        return;\r\n                    }\r\n                    return;\r\n                }\r\n\r\n                const pageBtn = target.closest(\".page-btn[data-page]\");\r\n                if (\r\n                    pageBtn &&\r\n                    !pageBtn.disabled &&\r\n                    !pageBtn.classList.contains(\"active\")\r\n                ) {\r\n                    const page = parseInt(pageBtn.dataset.page, 10);\r\n                    if (page !== state.currentPage && !state.loading) {\r\n                        await fetchFolderItems(state.currentFolder, page);\r\n                        scrollToTop();\r\n                    }\r\n                    return;\r\n                }\r\n\r\n                // Retry button\r\n                const retryBtn = target.closest(\".retry-btn\");\r\n                if (retryBtn) {\r\n                    state.error = null;\r\n                    state.loading = true;\r\n                    renderApp();\r\n                    try {\r\n                        await fetchAllFolders(false);\r\n                    } catch (error) {\r\n                        showError(`重试失败: ${error.message}`);\r\n                        renderApp();\r\n                    }\r\n                    return;\r\n                }\r\n            };\r\n            app.addEventListener(\"click\", appClickHandler);\r\n        }\r\n\r\n        function bindGlobalEvents() {\r\n            let lastVisibilityChange = Date.now();\r\n            let needReloadOnReturn = false;\r\n            const RELOAD_THRESHOLD = 5 * 60 * 1000;\r\n\r\n            visibilityHandler = function () {\r\n                const now = Date.now();\r\n\r\n                if (document.visibilityState === \"hidden\") {\r\n                    lastVisibilityChange = now;\r\n                } else if (document.visibilityState === \"visible\") {\r\n                    const timeAway = now - lastVisibilityChange;\r\n                    if (\r\n                        isInitialized &&\r\n                        !state.loading &&\r\n                        state.folders.length > 0 &&\r\n                        (timeAway > RELOAD_THRESHOLD || needReloadOnReturn)\r\n                    ) {\r\n                        fetchFolderItems(\r\n                            state.currentFolder,\r\n                            state.currentPage,\r\n                            false\r\n                        );\r\n                        needReloadOnReturn = false;\r\n                    }\r\n                }\r\n            };\r\n            document.addEventListener(\"visibilitychange\", visibilityHandler);\r\n        }\r\n\r\n        // Bind all events\r\n        function bindEvents() {\r\n            bindAppContainerEvents();\r\n            bindGlobalEvents();\r\n        }\r\n        function scrollToTop() {\r\n            const contentArea = app.querySelector(\".fav-section\");\r\n            if (contentArea) {\r\n                window.scrollTo({\r\n                    top: contentArea.offsetTop - 80,\r\n                    behavior: \"smooth\",\r\n                });\r\n            }\r\n        }\r\n\r\n        function setupScrollEffects() {\r\n            const itemObserver = new IntersectionObserver(\r\n                (entries) => {\r\n                    entries.forEach((entry) => {\r\n                        if (entry.isIntersecting) {\r\n                            entry.target.classList.add(\"visible\");\r\n                            itemObserver.unobserve(entry.target);\r\n                        }\r\n                    });\r\n                },\r\n                { threshold: 0.1, rootMargin: \"0px 0px -50px 0px\" }\r\n            );\r\n\r\n            const items = app.querySelectorAll(\".fav-item:not(.visible)\");\r\n            items.forEach((item, index) => {\r\n                item.style.animationDelay = `${index * 0.05}s`; // Keep delay\r\n                itemObserver.observe(item);\r\n            });\r\n        }\r\n\r\n        function appMutationCallback (mutationsList){\r\n            for (const mutation of mutationsList) {\r\n                if (mutation.type === \"childList\") {\r\n                    mutation.addedNodes.forEach((node) => {\r\n                        if (node.nodeType === 1) {\r\n                            if (node.classList.contains(\"fav-item\")) {\r\n                                setupScrollEffects();\r\n                            }\r\n                            node.querySelectorAll(\r\n                                \"img.fav-thumb-img[data-src]\"\r\n                            ).forEach((img) => {\r\n                                if (imgObserverInstance)\r\n                                    imgObserverInstance.observe(img);\r\n                            });\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        };\r\n\r\n        function debounce(func, wait = 50) {\r\n            let timeout;\r\n            return function (...args) {\r\n                clearTimeout(timeout);\r\n                timeout = setTimeout(() => func.apply(this, args), wait);\r\n            };\r\n        }\r\n\r\n        function setupScrollAnimations() {\r\n            if (scrollHandler) {\r\n                window.removeEventListener(\"scroll\", scrollHandler);\r\n            }\r\n\r\n            scrollHandler = debounce(() => {\r\n                // 选择没有 'fav-item-exit' 类的项目来应用 'visible'\r\n                const items = app.querySelectorAll(\r\n                    \".fav-item:not(.visible):not(.fav-item-exit)\"\r\n                );\r\n                const viewportHeight = window.innerHeight;\r\n                items.forEach((item) => {\r\n                    const rect = item.getBoundingClientRect();\r\n                    if (\r\n                        rect.top < viewportHeight * 0.9 &&\r\n                        rect.bottom > viewportHeight * 0.1\r\n                    ) {\r\n                        // .visible 类现在可以只用于标记是否已滚动到视图，而不是控制入场动画\r\n                        item.classList.add(\"visible\");\r\n                    }\r\n                });\r\n            }, 50); // Adjust debounce wait time as needed\r\n\r\n            window.addEventListener(\"scroll\", scrollHandler);\r\n            requestAnimationFrame(scrollHandler); // 使用 rAF 确保在布局后执行初始检查\r\n        }\r\n\r\n        function setupImageLazyLoading() {\r\n            if (imgObserverInstance) {\r\n                imgObserverInstance.disconnect();\r\n            }\r\n\r\n            const observer = new IntersectionObserver(\r\n                (entries, obs) => {\r\n                    entries.forEach((entry) => {\r\n                        if (entry.isIntersecting) {\r\n                            const img = entry.target;\r\n                            const src = img.getAttribute(\"data-src\");\r\n                            if (src) {\r\n                                const placeholder = img.previousElementSibling;\r\n\r\n                                img.onload = () => {\r\n                                    img.classList.add(\"loaded\");\r\n                                    if (\r\n                                        placeholder &&\r\n                                        placeholder.classList.contains(\r\n                                            \"fav-item-thumb-placeholder\"\r\n                                        )\r\n                                    ) {\r\n                                        placeholder.style.display = \"none\";\r\n                                    }\r\n                                };\r\n                                img.onerror = () => window.imgError(this);\r\n                                img.src = src;\r\n                                img.removeAttribute(\"data-src\");\r\n                            }\r\n                            obs.unobserve(img);\r\n                        }\r\n                    });\r\n                },\r\n                { threshold: 0.05, rootMargin: \"150px\" }\r\n            );\r\n\r\n            if (app) {\r\n                app.querySelectorAll(\"img.fav-thumb-img[data-src]\").forEach(\r\n                    (img) => observer.observe(img)\r\n                );\r\n            }\r\n            return observer;\r\n        }\r\n\r\n        // --- Video Modal ---\r\n        function setupVideoModal() {\r\n            videoContainer = document.querySelector(\".video-modal\");\r\n\r\n            function closeVideoModal () {\r\n                if (!videoContainer) return;\r\n                const container = videoContainer.querySelector(\".video-modal-container\");\r\n                const iframe = videoContainer.querySelector(\".video-modal-iframe\");\r\n\r\n                container.style.transform = \"translateY(20px)\";\r\n                container.style.opacity = \"0\";\r\n\r\n                setTimeout(() => {\r\n                        videoContainer.classList.remove(\"active\");\r\n                        videoContainer.close();\r\n                        document.body.style.overflow = \"\";\r\n                        if (iframe) iframe.src = \"about:blank\";\r\n                }, 300);\r\n            };\r\n            videoContainer.querySelector(\".video-modal-close\").addEventListener(\"click\", closeVideoModal);\r\n            videoContainer.addEventListener(\"click\", (e) => {\r\n                if (e.target === videoContainer) {\r\n                    closeVideoModal();\r\n                }\r\n            });\r\n            return videoContainer;\r\n        }\r\n\r\n        function handleFavItemClick(favItem) {\r\n            const bvid = favItem.getAttribute(\"data-bvid\");\r\n            if (bvid && videoContainer) {\r\n                const title = favItem.getAttribute(\"data-title\");\r\n                const upName = favItem.getAttribute(\"data-up\");\r\n\r\n                videoContainer.querySelector(\".video-modal-title\").textContent = title;\r\n                videoContainer.querySelector(\".video-modal-up-name\").textContent = \"UP: \" + upName;\r\n                videoContainer.querySelector(\".video-modal-open\").href = `https://www.bilibili.com/video/${bvid}`;\r\n\r\n                const iframe = videoContainer.querySelector(\".video-modal-iframe\");\r\n                iframe.src = `https://player.bilibili.com/player.html?bvid=${bvid}&page=1&autoplay=1&danmaku=1`;\r\n\r\n                videoContainer.showModal();\r\n                videoContainer.classList.add(\"active\");\r\n                document.body.style.overflow = \"hidden\";\r\n\r\n                setTimeout(() => {\r\n                    if (videoContainer) {\r\n                        const container = videoContainer.querySelector(\".video-modal-container\");\r\n                        if (container) {\r\n                            container.style.transform = \"translateY(0)\";\r\n                            container.style.opacity = \"1\";\r\n                        }\r\n                    }\r\n                }, 10);\r\n            }\r\n        }\r\n\r\n        function setupVideoItemsClickEvent() {\r\n            if (videoClickHandler) {\r\n                document.removeEventListener(\"click\", videoClickHandler);\r\n            }\r\n\r\n            videoClickHandler = (e) => {\r\n                const favItem = e.target.closest(\".fav-item\");\r\n                if (favItem) {\r\n                    e.preventDefault();\r\n                    handleFavItemClick(favItem);\r\n                }\r\n            };\r\n            document.addEventListener(\"click\", videoClickHandler);\r\n        }\r\n\r\n        // --- Initialization ---\r\n        await initApp();\r\n\r\n        if (appObserverInstance) {\r\n            appObserverInstance.disconnect();\r\n        }\r\n        appObserverInstance = new MutationObserver(appMutationCallback);\r\n        if (app) {\r\n            appObserverInstance.observe(app, {\r\n                childList: true,\r\n                subtree: true,\r\n            });\r\n        }\r\n    } catch (error) {\r\n        if (app) {\r\n            app.innerHTML = `\r\n                <div class=\"fav-empty\">\r\n                <p>加载收藏夹时发生严重错误: ${error.message || \"未知错误\"}</p>\r\n                <button class=\"page-btn retry-btn\">重试</button>\r\n                </div>\r\n            `;\r\n            app.querySelector(\".retry-btn\")?.addEventListener(\"click\", initBilibiliFavList);\r\n        }\r\n        isInitialized = false;\r\n    }\r\n};","export default function init_comment_captcha() {\r\n\r\n    document.addEventListener(\"pjax:complete\",init);\r\n    function init(){\r\n        iroCaptcha();\r\n        cfts();\r\n    }\r\n    init();\r\n\r\n    function iroCaptcha() {\r\n        let captchaHideTimeout = null;\r\n        let captchaField = document.querySelector('.comment-captcha .input');\r\n        let captchaImg = document.querySelector('.comment-captcha img');\r\n        \r\n        if (captchaField && captchaImg) {\r\n            captchaImg.addEventListener('click',refreshCaptcha);\r\n            captchaField.addEventListener('focus',showCaptcha);\r\n            captchaField.addEventListener('blur',hideCaptcha);\r\n            captchaImg.onerror = function() {\r\n                refreshCaptcha();\r\n                captchaImg.onerror = ''\r\n            }\r\n        }\r\n    \r\n        function showCaptcha() {\r\n            if (!captchaImg.dataset.loaded) {\r\n                captchaImg.dataset.loaded = true;\r\n                refreshCaptcha();\r\n            };\r\n            captchaField.setAttribute(\"placeholder\", \"\");\r\n            if (captchaHideTimeout) {\r\n                clearTimeout(captchaHideTimeout);\r\n                captchaHideTimeout = null;\r\n            }\r\n            captchaImg.style.width = \"120px\";\r\n            captchaImg.style.marginRight = \"10px\";\r\n        }\r\n    \r\n        function hideCaptcha() {\r\n            let placeholder = captchaField.dataset.placeholder || '点击此处验证';\r\n            captchaHideTimeout = setTimeout(function() {\r\n                captchaImg.style.width = \"0\";\r\n                captchaImg.style.marginRight = \"0\";\r\n                captchaField.setAttribute(\"placeholder\",placeholder);\r\n            }, 5000);\r\n        }\r\n            \r\n        function refreshCaptcha() {\r\n            fetch(_iro.captcha_endpoint)\r\n                .then(resp => resp.json())\r\n                .then(json => {\r\n                    captchaImg.src = json[\"data\"];\r\n                    document.querySelector(\"input[name=\\'timestamp\\']\").value = json[\"time\"];\r\n                    document.querySelector(\"input[name=\\'id\\']\").value = json[\"id\"];\r\n                })\r\n                .catch(error => console.error(\"获取验证码失败:\", error));\r\n        };\r\n    }\r\n\r\n    function cfts(){\r\n        let cfturnstile = document.querySelector('.comment-form .cfturnstile');\r\n        if (cfturnstile) {\r\n            let theme = \"light\";\r\n            let response = document.querySelector(\".comment-form .cf-turnstile-response\");\r\n            function loadTurnstile() {\r\n                return new Promise((resolve, reject) => {\r\n                    const script = document.createElement('script');\r\n                    script.src = 'https://challenges.cloudflare.com/turnstile/v0/api.js';\r\n                    script.onload = resolve;\r\n                    script.onerror = reject;\r\n                    document.head.appendChild(script);\r\n                });\r\n            }\r\n            loadTurnstile().then(()=>{\r\n                theme = document.querySelector('body.dark') ? \"dark\" : \"light\";\r\n                turnstile.render(cfturnstile, {\r\n                        sitekey: `${cfturnstile.dataset.key}`,\r\n                        theme: `${theme}`,\r\n                        callback: function(token) {\r\n                            response.value = token;\r\n                        },\r\n                    });\r\n                }\r\n            )\r\n        }\r\n    }\r\n}","import article_attach from './artile_attachment'\r\nimport { ready, slideToggle, buildAPI } from '../common/util'\r\nimport lazyload from \"../common/lazyload\"\r\nimport { createButterbar } from '../common/butterbar'\r\nimport './global-func'\r\nimport getqqinfo from './getqqinfo'\r\nimport addComment from './AddComment'\r\nimport { _$, __ } from '../common/sakurairo_global'\r\nimport LoadNextPage from './pagination'\r\nimport debounce from '@mui/utils/debounce'\r\nimport { code_highlight_style } from '../common/code-highlight'\r\nimport prepareEmoji from './emoji'\r\nimport initAnnotations from './annotation'\r\nimport initLinkSubmission from './link_form'\r\nimport init_steamCard from './steam_card'\r\nimport ghcardTheme from './ghcard_theme'\r\nimport initTimeArchive from './time_archive'\r\nimport bili_fav_init from './bili_fav'\r\nimport init_comment_captcha from './comment_captcha'\r\n\r\nfunction apply_post_theme_color() {\r\n    if (_iro.post_theme_color != false && _iro.post_theme_color != 'false') {\r\n        let post_theme_color = _iro.post_theme_color;\r\n        document.documentElement.style.setProperty('--article-theme-highlight', post_theme_color);\r\n    } else {\r\n        document.documentElement.style.removeProperty('--article-theme-highlight');\r\n    }\r\n}\r\n\r\nfunction click_to_view_image() {\r\n    const comment_inline = document.getElementsByClassName('comment_inline_img');\r\n    if (!comment_inline.length) return;\r\n    document.getElementsByClassName(\"comments-main\")[0].addEventListener(\"click\", function (e) {\r\n        if (e.target.classList.contains(\"comment_inline_img\")) {\r\n            window.open(e.target.src);\r\n        }\r\n    })\r\n}\r\nfunction clean_upload_images() {\r\n    document.getElementById(\"upload-img-show\").innerHTML = '';\r\n}\r\nfunction original_emoji_click() {\r\n    const emoji = document.getElementsByClassName('emoji-item');\r\n    if (!emoji.length) return;\r\n    document.querySelector(\".menhera-container\").addEventListener(\"click\", function (e) {\r\n        if (e.target.classList.contains(\"emoji-item\")) {\r\n            grin(e.target.innerText, \"custom\", \"`\", \"` \");\r\n        }\r\n    })\r\n}\r\nfunction XCS() {\r\n    const __list = 'commentwrap';\r\n    const form = document.getElementById(\"commentform\")\r\n    if (form) {\r\n        let statusSubmitting = false\r\n        form.addEventListener('submit', function (event) {\r\n            event.stopPropagation()\r\n            event.preventDefault();\r\n            if (statusSubmitting) return\r\n            const butterBarRef = createButterbar(__(\"提交中....\"), true)\r\n            const form = new FormData(this)\r\n            form.append('action', 'ajax_comment')\r\n            statusSubmitting = true\r\n            fetch(_iro.ajaxurl, {\r\n                method: this.attributes.method.value,\r\n                body: form\r\n            }).then(async resp => {\r\n                const data = await resp.text()\r\n                if (resp.ok) {\r\n                    Array.from(document.getElementsByTagName('textarea'))\r\n                        .forEach((e) => e.value = '')\r\n                    const cancel = document.getElementById('cancel-comment-reply-link'),\r\n                        temp = document.getElementById('wp-temp-form-div'),\r\n                        respond = document.getElementById(addComment.respondId),\r\n                        //post = document.getElementById('comment_post_ID').value,\r\n                        parent = document.getElementById('comment_parent').value;\r\n                    if (parent != '0') {\r\n                        //jQuery('#respond').before('<ol class=\"children\">' + data + '</ol>');\r\n                        document.getElementById(\"respond\").insertAdjacentHTML('beforebegin', '<ol class=\"children\">' + data + '</ol>');\r\n                    } else if (!document.getElementsByClassName(__list).length) {\r\n                        if (_iro.formpostion == 'bottom') {\r\n                            document.getElementById(\"respond\").insertAdjacentHTML('beforebegin', '<ol class=\"' + __list + '\">' + data + '</ol>');\r\n                            //jQuery('#respond').before('<ol class=\"' + __list + '\">' + data + '</ol>');\r\n                        } else {\r\n                            document.getElementById(\"respond\").insertAdjacentHTML('afterend', '<ol class=\"' + __list + '\">' + data + '</ol>');\r\n                            //jQuery('#respond').after('<ol class=\"' + __list + '\">' + data + '</ol>');\r\n                        }\r\n                    } else {\r\n                        if (_iro.order == 'asc') {\r\n                            document.getElementsByClassName(\"commentwrap\")[1].insertAdjacentHTML('beforeend', data);\r\n                            //jQuery('.' + __list).append(data);\r\n                        } else {\r\n                            document.getElementsByClassName(\"commentwrap\")[1].insertAdjacentHTML('afterbegin', data);\r\n                            //jQuery('.' + __list).prepend(data);\r\n                        }\r\n                    }\r\n                    createButterbar(__(\"提交成功\"));\r\n                    document.dispatchEvent(new CustomEvent('ajax_comment_complete',))\r\n                    cancel.style.display = 'none';\r\n                    cancel.onclick = null;\r\n                    document.getElementById('comment_parent').value = '0';\r\n                    if (temp && respond) {\r\n                        temp.parentNode.insertBefore(respond, temp);\r\n                        temp.remove();\r\n                        //temp.parentNode.removeChild(temp)\r\n                    }\r\n                } else {\r\n                    createButterbar(data || 'HTTP' + resp.status + ':' + resp.statusText);\r\n                }\r\n            }).catch(reason => {\r\n                createButterbar(reason);\r\n            }).finally(() => {\r\n                butterBarRef.remove()\r\n                statusSubmitting = false\r\n            })\r\n            /* jQuery.ajax({\r\n                url: _iro.ajaxurl,\r\n                data: jQuery(this).serialize() + \"&action=ajax_comment\",\r\n                type: jQuery(this).attr('method'),\r\n                beforeSend: createButterbar(\"提交中(Commiting)....\"),\r\n                error: function (request) {\r\n                    var t = addComment;\r\n                    t.createButterbar(request.responseText);\r\n                },\r\n                success: function (data) {\r\n                    jQuery('textarea').each(function () {\r\n                        this.value = ''\r\n                    });\r\n                    var t = addComment,\r\n                        cancel = t.I('cancel-comment-reply-link'),\r\n                        temp = t.I('wp-temp-form-div'),\r\n                        respond = t.I(t.respondId),\r\n                        post = t.I('comment_post_ID').value,\r\n                        parent = t.I('comment_parent').value;\r\n                    if (parent != '0') {\r\n                        jQuery('#respond').before('<ol class=\"children\">' + data + '</ol>');\r\n                    } else if (!jQuery('.' + __list).length) {\r\n                        if (_iro.formpostion == 'bottom') {\r\n                            jQuery('#respond').before('<ol class=\"' + __list + '\">' + data + '</ol>');\r\n                        } else {\r\n                            jQuery('#respond').after('<ol class=\"' + __list + '\">' + data + '</ol>');\r\n                        }\r\n                    } else {\r\n                        if (_iro.order == 'asc') {\r\n                            jQuery('.' + __list).append(data);\r\n                        } else {\r\n                            jQuery('.' + __list).prepend(data);\r\n                        }\r\n                    }\r\n                    t.createButterbar(\"提交成功(Succeed)\");\r\n                    lazyload();\r\n                    code_highlight_style();\r\n                    click_to_view_image();\r\n                    clean_upload_images();\r\n                    cancel.style.display = 'none';\r\n                    cancel.onclick = null;\r\n                    t.I('comment_parent').value = '0';\r\n                    if (temp && respond) {\r\n                        temp.parentNode.insertBefore(respond, temp);\r\n                        temp.remove();\r\n                        //temp.parentNode.removeChild(temp)\r\n                    }\r\n                }\r\n            }); */\r\n        })\r\n    }\r\n}\r\n\r\nfunction XCP() {\r\n    document.body.addEventListener('click', function (e) {\r\n        if (e.target.parentNode == document.getElementById(\"comments-navi\") && e.target.nodeName.toLowerCase() == \"a\") {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            let _this = e.target,\r\n                path = _this.pathname,\r\n                _xhr = new XMLHttpRequest();\r\n            _xhr.open(\"GET\", _this.getAttribute('href'), true);\r\n            _xhr.responseType = \"document\";\r\n            _xhr.onloadstart = () => {\r\n                let comments_navi = document.getElementById(\"comments-navi\"),\r\n                    commentwrap = document.querySelector(\"ul.commentwrap\"),\r\n                    loading_comments = document.getElementById(\"loading-comments\"),\r\n                    comments_list = document.getElementById(\"comments-list-title\");\r\n                comments_navi.remove();\r\n                commentwrap.remove();\r\n                //comments_navi.parentNode.removeChild(comments_navi);\r\n                //commentwrap.parentNode.removeChild(commentwrap);\r\n                loading_comments.style.display = \"block\";\r\n                slideToggle(loading_comments, 500, \"show\");\r\n                window.scrollTo({\r\n                    top: comments_list.getBoundingClientRect().top + window.pageYOffset - comments_list.clientTop - 65,\r\n                    behavior: \"smooth\"\r\n                });\r\n            }\r\n            _xhr.onreadystatechange = function () {\r\n                if (_xhr.readyState == 4 && _xhr.status == 200) {\r\n                    let json = _xhr.response,\r\n                        result = json.querySelector(\"ul.commentwrap\"),\r\n                        nextlink = json.getElementById(\"comments-navi\"),\r\n                        loading_comments = document.getElementById(\"loading-comments\");\r\n                    slideToggle(loading_comments, 200, \"hide\");\r\n                    document.getElementById(\"loading-comments\").insertAdjacentHTML('afterend', result.outerHTML);\r\n                    document.querySelector(\"ul.commentwrap\").insertAdjacentHTML('afterend', nextlink.outerHTML);\r\n                    lazyload();\r\n                    if (window.gtag) {\r\n                        gtag('config', _iro.google_analytics_id, {\r\n                            'page_path': path\r\n                        });\r\n                    }\r\n                    code_highlight_style();\r\n                    click_to_view_image();\r\n                    let commentwrap = document.querySelector(\"ul.commentwrap\");\r\n                    window.scrollTo({\r\n                        top: commentwrap && (commentwrap.getBoundingClientRect().top + window.pageYOffset - commentwrap.clientTop - 200),\r\n                        behavior: \"smooth\"\r\n                    });\r\n                }\r\n            }\r\n            _xhr.send();\r\n        }\r\n    });\r\n}\r\nfunction sm() {\r\n    let sm = document.getElementsByClassName('sm'),\r\n        cm = document.querySelector(\".comments-main\");\r\n    if (!sm.length) return;\r\n    if (cm) {\r\n        cm.addEventListener(\"click\", function (e) {\r\n            if (e.target.classList.contains(\"comment-reply-link\")) {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                let data_commentid = e.target.getAttribute(\"data-commentid\");\r\n                addComment.moveForm(\"comment-\" + data_commentid, data_commentid, \"respond\", this.getAttribute(\"data-postid\"));\r\n            }\r\n        })\r\n        cm.addEventListener(\"click\", (e) => {\r\n            let list = e.target.parentNode;\r\n            if (list.classList.contains(\"sm\")) {\r\n                let msg = __(\"您真的要设为私密吗？\");\r\n                if (confirm(msg) == true) {\r\n                    if (list.classList.contains('private_now')) {\r\n                        alert(__('您之前已设过私密评论'));\r\n                        return false;\r\n                    } else {\r\n                        list.classList.add('private_now');\r\n                        let idp = list.getAttribute(\"data-idp\"),\r\n                            actionp = list.getAttribute(\"data-actionp\"),\r\n                            rateHolderp = list.getElementsByClassName('has_set_private')[0];\r\n                        let ajax_data = \"action=siren_private&p_id=\" + idp + \"&p_action=\" + actionp;\r\n                        let request = new XMLHttpRequest();\r\n                        request.onreadystatechange = function () {\r\n                            if (this.readyState == 4 && this.status == 200) {\r\n                                rateHolderp.innerHTML = request.responseText;\r\n                            }\r\n                        };\r\n                        request.open('POST', _iro.ajaxurl, true);\r\n                        request.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\r\n                        request.send(ajax_data);\r\n                        return false;\r\n                    }\r\n                }\r\n            }\r\n        })\r\n    }\r\n}\r\nfunction throttling(fn, wait, maxTimelong) {\r\n    let timeout = null,\r\n        startTime = Date.parse(new Date);\r\n    return function () {\r\n        if (timeout !== null) clearTimeout(timeout);\r\n        let curTime = Date.parse(new Date);\r\n        if (curTime - startTime >= maxTimelong) {\r\n            fn();\r\n            startTime = curTime;\r\n        } else {\r\n            timeout = setTimeout(fn, wait);\r\n        }\r\n    }\r\n}\r\nfunction resizeTOC() {\r\n    const toc_container = document.querySelector(\".toc-container\"),\r\n        sc = document.querySelector(\".site-content\")\r\n    if (toc_container && sc) {\r\n        const resize = () => {\r\n            toc_container.style.height = Math.min(sc.getBoundingClientRect()[\"height\"], document.documentElement.offsetHeight - toc_container.offsetTop) + \"px\";\r\n        }\r\n        resize()\r\n        //TODO:性能\r\n        window.addEventListener('resize', debounce(resize), { passive: true })\r\n        document.addEventListener('scroll', throttling(resize, 200, 1000))\r\n    }\r\n}\r\nfunction tableOfContentScroll(flag) {\r\n    let tocContainer = document.getElementsByClassName(\"toc-container\")[0];\r\n    let hasToc = document.querySelector(\"div.have-toc\") || document.querySelector(\"div.has-toc\");\r\n    if (!hasToc) {\r\n        if (tocContainer) {\r\n            tocContainer.style.display = \"none\";\r\n        }\r\n        document.dispatchEvent(new CustomEvent(\"tocEvent\", { detail: false }))\r\n    } else {\r\n        if (tocContainer) {\r\n            tocContainer.style.display = \"\";\r\n        }\r\n        if (flag && document.getElementsByClassName('toc').length > 0) {\r\n            import('tocbot').then(({ default: tocbot }) => {\r\n                tocbot.init({\r\n                    tocSelector: '#main-container .toc',\r\n                    contentSelector: ['.entry-content', '.links'],\r\n                    headingSelector: 'h1,h2,h3,h4,h5',\r\n                    headingsOffset: heading_fix - window.innerHeight / 2,\r\n                    onClick: null\r\n                });\r\n            })\r\n            const heading_fix = _iro.entry_content_style == \"sakurairo\" ? (document.querySelector(\"article.type-post\") ? (document.querySelector(\"div.pattern-attachment\") ? -75 : 200) : 375) : window.innerHeight / 2;\r\n            const _els = document.querySelectorAll('.entry-content,.links');\r\n            const idSet = new Set()\r\n            let id = 1\r\n            for (let i = 0; i < _els.length; i++) {\r\n                let _el = _els[i].querySelectorAll('h1,h2,h3,h4,h5');\r\n                for (const title of _el) {\r\n                    const validId = generateValidId(title.innerText, idSet, id);\r\n                    if (idSet.has(validId)) {\r\n                        title.id = \"toc-head-\" + id++;\r\n                    } else {\r\n                        title.id = validId;\r\n                        idSet.add(validId);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        document.dispatchEvent(new CustomEvent(\"tocEvent\", { detail: true }))\r\n    }\r\n}\r\n\r\n//转义id，防止使用中文字符报错\r\nfunction generateValidId(text, idSet, index) {\r\n    // 去除首尾空白并将空格替换为 -\r\n    let newId = text.trim().replace(/\\s+/g, '-');\r\n    // 移除除字母、数字、下划线和连字符之外的所有字符\r\n    newId = newId.replace(/[^\\w\\-]/g, '');\r\n    // 如果处理后为空，则使用默认前缀\r\n    if (!newId) {\r\n        newId = \"heading-\" + index;\r\n    }\r\n    // 避免重复\r\n    while (idSet.has(newId)) {\r\n        newId += \"-\" + index;\r\n    }\r\n    idSet.add(newId);\r\n    return newId;\r\n}\r\n/**\r\n * 上传图片提示\r\n */\r\nfunction attach_image() {\r\n    let cached = document.getElementsByClassName(\"insert-image-tips\")[0],\r\n        upload_img = document.getElementById('upload-img-file');\r\n    if (!upload_img) return;\r\n    upload_img.addEventListener(\"change\", (function () {\r\n        if (this.files.length > 10) {\r\n            createButterbar(__(\"每次上传上限为10张\"));\r\n            return 0;\r\n        }\r\n        for (let i = 0; i < this.files.length; i++) {\r\n            let max_size = _iro.img_upload_max_size || 5;\r\n            if (this.files[i].size >= max_size *1024 *1024) {\r\n                let alerts = `The maximum upload size for images is${max_size} MB\\n\\n${this.files[i].name}\\n\\nThis image is too large~ Please upload it again!`;\r\n                switch (_iro.language) {\r\n                    case \"zh_CN\":\r\n                        alerts = `图片上传大小限制为${max_size} MB\\n\\n${this.files[i].name}\\n\\n这张图太大啦~请重新上传噢！`;\r\n                        break;\r\n                    case \"zh_TW\":\r\n                        alerts = `圖片上傳大小限制為${max_size} MB\\n\\n${this.files[i].name}\\n\\n這張圖太大啦~請重新上傳噢！`;\r\n                        break;\r\n                    case \"ja\":\r\n                        alerts = `画像アップロードのサイズ制限は${max_size} MBです\\n\\n${this.files[i].name}\\n\\nこの画像は大きすぎます～再度アップロードしてください！`;\r\n                        break;\r\n                    case \"fr\":\r\n                        alerts = `La taille maximale de téléchargement des images est de ${max_size} Mo\\n\\n« ${this.files[i].name} »\\n\\nCette image est trop volumineuse ~ Veuillez la télécharger à nouveau !`;\r\n                        break;\r\n                }\r\n                alert(alerts);\r\n                return;\r\n            }\r\n        }\r\n        for (let i = 0; i < this.files.length; i++) {\r\n            let f = this.files[i],\r\n                formData = new FormData(),\r\n                xhr = new XMLHttpRequest();\r\n            formData.append('cmt_img_file', f);\r\n            xhr.addEventListener('loadstart', function () {\r\n                cached.innerHTML = '<i class=\"fa-solid fa-circle-notch fa-spin\"></i>';\r\n                createButterbar(__(\"上传中...\"));\r\n            });\r\n            xhr.open(\"POST\", buildAPI(_iro.api + 'sakura/v1/image/upload'), true);\r\n            xhr.send(formData);\r\n            xhr.onreadystatechange = function () {\r\n                if (xhr.readyState == 4 && (xhr.status == 200 || xhr.status == 304)) {\r\n                    cached.innerHTML = '<i class=\"fa-solid fa-check\"></i>';\r\n                    setTimeout(function () {\r\n                        cached.innerHTML = '<i class=\"fa-regular fa-image\"></i>';\r\n                    }, 1000);\r\n                    let res = JSON.parse(xhr.responseText);\r\n                    if (res.status == 200) {\r\n                        let get_the_url = res.proxy;\r\n                        document.getElementById(\"upload-img-show\").insertAdjacentHTML('afterend', '<img class=\"lazyload upload-image-preview\" src=\"' + _iro.loading_ph + '\" data-src=\"' + get_the_url + '\" onclick=\"window.open(\\'' + get_the_url + '\\')\" onerror=\"imgError(this)\" />');\r\n                        lazyload();\r\n                        createButterbar(__(\"图片上传成功~\"));\r\n                        grin(get_the_url, type = 'Img');\r\n                    } else {\r\n                        createButterbar(_$('上传失败！\\n文件名: {0}\\ncode: {1}\\n{2}', f.name, res.status, res.message), 3000)\r\n                    }\r\n                } else if (xhr.readyState == 4) {\r\n                    cached.innerHTML = '<i class=\"fa-regular fa-clock\" aria-hidden=\"true\" style=\"color:red\"></i>';\r\n                    alert(__(\"上传失败，请重试.\"));\r\n                    setTimeout(function () {\r\n                        cached.innerHTML = '<i class=\"fa-regular fa-image\"></i>';\r\n                    }, 1000);\r\n                }\r\n            }\r\n        }\r\n    }));\r\n}\r\n\r\n/**\r\n * 添加上传图片的提示\r\n */\r\nfunction add_upload_tips() {\r\n    const form_submit = document.querySelector('.form-submit #submit');\r\n    if (form_submit == null) return;\r\n    if (!_iro.comment_upload_img) {\r\n        return\r\n    }\r\n    attach_image();\r\n\r\n    const file_submit = document.getElementById('upload-img-file'),\r\n        hover = document.getElementsByClassName('insert-image-tips')[0],\r\n        Tip = document.getElementById('uploadTipPopup');\r\n    if (!file_submit) return;\r\n    file_submit.addEventListener(\"mouseenter\", function () {\r\n        hover.classList.toggle('insert-image-tips-hover');\r\n        Tip.classList.toggle('show');\r\n    });\r\n    file_submit.addEventListener(\"mouseleave\", function () {\r\n        hover.classList.toggle('insert-image-tips-hover');\r\n        Tip.classList.toggle('show');\r\n    });\r\n}\r\nfunction addComtListener() {\r\n    document.querySelectorAll(\".comt-addsmilies\").forEach((e) => {\r\n        e.addEventListener(\"click\", () => {\r\n            if (e.stlye.display == \"block\") {\r\n                e.style.display = \"none\";\r\n            } else {\r\n                e.style.display = \"block\";\r\n            }\r\n        })\r\n    })\r\n    document.querySelectorAll(\".comt-smilies a\").forEach((e) => {\r\n        e.addEventListener(\"click\", () => {\r\n            e.parentNode.style.display = \"none\";\r\n        })\r\n    })\r\n}\r\nfunction afterAjaxCommentComplete() {\r\n    lazyload();\r\n    code_highlight_style();\r\n    click_to_view_image();\r\n    clean_upload_images();\r\n}\r\n\r\n// #region LifeCycle\r\nfunction whilePopstate() {\r\n    article_attach()\r\n    sm()\r\n}\r\nfunction whileReady() {\r\n    article_attach()\r\n    XCS()\r\n    XCP()\r\n    getqqinfo()\r\n    add_upload_tips()\r\n    ghcardTheme()\r\n}\r\nfunction whilePjaxComplete() {\r\n    try {\r\n        add_upload_tips()\r\n        article_attach()\r\n        LoadNextPage();\r\n        tableOfContentScroll(true);\r\n        click_to_view_image()\r\n        getqqinfo()\r\n        sm()\r\n        original_emoji_click()\r\n        code_highlight_style()\r\n        prepareEmoji()\r\n        XCS()\r\n        resizeTOC()\r\n        initAnnotations();\r\n        apply_post_theme_color();\r\n        initLinkSubmission();\r\n        init_steamCard();\r\n        initTimeArchive();\r\n    } catch (e) {\r\n        console.warn(e)\r\n    }\r\n}\r\nfunction whileLoaded() {\r\n    window.addEventListener('popstate', whilePopstate)\r\n    click_to_view_image()\r\n    code_highlight_style()\r\n    LoadNextPage();\r\n    sm()\r\n    original_emoji_click()\r\n    prepareEmoji()\r\n    tableOfContentScroll(true);\r\n    addComtListener()\r\n    resizeTOC()\r\n    initAnnotations();\r\n    apply_post_theme_color();\r\n    document.addEventListener('ajax_comment_complete', afterAjaxCommentComplete)\r\n    initLinkSubmission();\r\n    init_steamCard();\r\n    initTimeArchive();\r\n    bili_fav_init();\r\n    init_comment_captcha();\r\n}\r\nwhileLoaded()\r\ndocument.addEventListener('pjax:complete', whilePjaxComplete)\r\nready(whileReady)\r\n//#endregion","// Corresponds to 10 frames at 60 Hz.\n// A few bytes payload overhead when lodash/debounce is ~3 kB and debounce ~300 B.\nexport default function debounce(func, wait = 166) {\n  let timeout;\n  function debounced(...args) {\n    const later = () => {\n      // @ts-ignore\n      func.apply(this, args);\n    };\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n  }\n  debounced.clear = () => {\n    clearTimeout(timeout);\n  };\n  return debounced;\n}","(function(){\r\n  var crypt = require('crypt'),\r\n      utf8 = require('charenc').utf8,\r\n      isBuffer = require('is-buffer'),\r\n      bin = require('charenc').bin,\r\n\r\n  // The core\r\n  md5 = function (message, options) {\r\n    // Convert to byte array\r\n    if (message.constructor == String)\r\n      if (options && options.encoding === 'binary')\r\n        message = bin.stringToBytes(message);\r\n      else\r\n        message = utf8.stringToBytes(message);\r\n    else if (isBuffer(message))\r\n      message = Array.prototype.slice.call(message, 0);\r\n    else if (!Array.isArray(message) && message.constructor !== Uint8Array)\r\n      message = message.toString();\r\n    // else, assume byte array already\r\n\r\n    var m = crypt.bytesToWords(message),\r\n        l = message.length * 8,\r\n        a =  1732584193,\r\n        b = -271733879,\r\n        c = -1732584194,\r\n        d =  271733878;\r\n\r\n    // Swap endian\r\n    for (var i = 0; i < m.length; i++) {\r\n      m[i] = ((m[i] <<  8) | (m[i] >>> 24)) & 0x00FF00FF |\r\n             ((m[i] << 24) | (m[i] >>>  8)) & 0xFF00FF00;\r\n    }\r\n\r\n    // Padding\r\n    m[l >>> 5] |= 0x80 << (l % 32);\r\n    m[(((l + 64) >>> 9) << 4) + 14] = l;\r\n\r\n    // Method shortcuts\r\n    var FF = md5._ff,\r\n        GG = md5._gg,\r\n        HH = md5._hh,\r\n        II = md5._ii;\r\n\r\n    for (var i = 0; i < m.length; i += 16) {\r\n\r\n      var aa = a,\r\n          bb = b,\r\n          cc = c,\r\n          dd = d;\r\n\r\n      a = FF(a, b, c, d, m[i+ 0],  7, -680876936);\r\n      d = FF(d, a, b, c, m[i+ 1], 12, -389564586);\r\n      c = FF(c, d, a, b, m[i+ 2], 17,  606105819);\r\n      b = FF(b, c, d, a, m[i+ 3], 22, -1044525330);\r\n      a = FF(a, b, c, d, m[i+ 4],  7, -176418897);\r\n      d = FF(d, a, b, c, m[i+ 5], 12,  1200080426);\r\n      c = FF(c, d, a, b, m[i+ 6], 17, -1473231341);\r\n      b = FF(b, c, d, a, m[i+ 7], 22, -45705983);\r\n      a = FF(a, b, c, d, m[i+ 8],  7,  1770035416);\r\n      d = FF(d, a, b, c, m[i+ 9], 12, -1958414417);\r\n      c = FF(c, d, a, b, m[i+10], 17, -42063);\r\n      b = FF(b, c, d, a, m[i+11], 22, -1990404162);\r\n      a = FF(a, b, c, d, m[i+12],  7,  1804603682);\r\n      d = FF(d, a, b, c, m[i+13], 12, -40341101);\r\n      c = FF(c, d, a, b, m[i+14], 17, -1502002290);\r\n      b = FF(b, c, d, a, m[i+15], 22,  1236535329);\r\n\r\n      a = GG(a, b, c, d, m[i+ 1],  5, -165796510);\r\n      d = GG(d, a, b, c, m[i+ 6],  9, -1069501632);\r\n      c = GG(c, d, a, b, m[i+11], 14,  643717713);\r\n      b = GG(b, c, d, a, m[i+ 0], 20, -373897302);\r\n      a = GG(a, b, c, d, m[i+ 5],  5, -701558691);\r\n      d = GG(d, a, b, c, m[i+10],  9,  38016083);\r\n      c = GG(c, d, a, b, m[i+15], 14, -660478335);\r\n      b = GG(b, c, d, a, m[i+ 4], 20, -405537848);\r\n      a = GG(a, b, c, d, m[i+ 9],  5,  568446438);\r\n      d = GG(d, a, b, c, m[i+14],  9, -1019803690);\r\n      c = GG(c, d, a, b, m[i+ 3], 14, -187363961);\r\n      b = GG(b, c, d, a, m[i+ 8], 20,  1163531501);\r\n      a = GG(a, b, c, d, m[i+13],  5, -1444681467);\r\n      d = GG(d, a, b, c, m[i+ 2],  9, -51403784);\r\n      c = GG(c, d, a, b, m[i+ 7], 14,  1735328473);\r\n      b = GG(b, c, d, a, m[i+12], 20, -1926607734);\r\n\r\n      a = HH(a, b, c, d, m[i+ 5],  4, -378558);\r\n      d = HH(d, a, b, c, m[i+ 8], 11, -2022574463);\r\n      c = HH(c, d, a, b, m[i+11], 16,  1839030562);\r\n      b = HH(b, c, d, a, m[i+14], 23, -35309556);\r\n      a = HH(a, b, c, d, m[i+ 1],  4, -1530992060);\r\n      d = HH(d, a, b, c, m[i+ 4], 11,  1272893353);\r\n      c = HH(c, d, a, b, m[i+ 7], 16, -155497632);\r\n      b = HH(b, c, d, a, m[i+10], 23, -1094730640);\r\n      a = HH(a, b, c, d, m[i+13],  4,  681279174);\r\n      d = HH(d, a, b, c, m[i+ 0], 11, -358537222);\r\n      c = HH(c, d, a, b, m[i+ 3], 16, -722521979);\r\n      b = HH(b, c, d, a, m[i+ 6], 23,  76029189);\r\n      a = HH(a, b, c, d, m[i+ 9],  4, -640364487);\r\n      d = HH(d, a, b, c, m[i+12], 11, -421815835);\r\n      c = HH(c, d, a, b, m[i+15], 16,  530742520);\r\n      b = HH(b, c, d, a, m[i+ 2], 23, -995338651);\r\n\r\n      a = II(a, b, c, d, m[i+ 0],  6, -198630844);\r\n      d = II(d, a, b, c, m[i+ 7], 10,  1126891415);\r\n      c = II(c, d, a, b, m[i+14], 15, -1416354905);\r\n      b = II(b, c, d, a, m[i+ 5], 21, -57434055);\r\n      a = II(a, b, c, d, m[i+12],  6,  1700485571);\r\n      d = II(d, a, b, c, m[i+ 3], 10, -1894986606);\r\n      c = II(c, d, a, b, m[i+10], 15, -1051523);\r\n      b = II(b, c, d, a, m[i+ 1], 21, -2054922799);\r\n      a = II(a, b, c, d, m[i+ 8],  6,  1873313359);\r\n      d = II(d, a, b, c, m[i+15], 10, -30611744);\r\n      c = II(c, d, a, b, m[i+ 6], 15, -1560198380);\r\n      b = II(b, c, d, a, m[i+13], 21,  1309151649);\r\n      a = II(a, b, c, d, m[i+ 4],  6, -145523070);\r\n      d = II(d, a, b, c, m[i+11], 10, -1120210379);\r\n      c = II(c, d, a, b, m[i+ 2], 15,  718787259);\r\n      b = II(b, c, d, a, m[i+ 9], 21, -343485551);\r\n\r\n      a = (a + aa) >>> 0;\r\n      b = (b + bb) >>> 0;\r\n      c = (c + cc) >>> 0;\r\n      d = (d + dd) >>> 0;\r\n    }\r\n\r\n    return crypt.endian([a, b, c, d]);\r\n  };\r\n\r\n  // Auxiliary functions\r\n  md5._ff  = function (a, b, c, d, x, s, t) {\r\n    var n = a + (b & c | ~b & d) + (x >>> 0) + t;\r\n    return ((n << s) | (n >>> (32 - s))) + b;\r\n  };\r\n  md5._gg  = function (a, b, c, d, x, s, t) {\r\n    var n = a + (b & d | c & ~d) + (x >>> 0) + t;\r\n    return ((n << s) | (n >>> (32 - s))) + b;\r\n  };\r\n  md5._hh  = function (a, b, c, d, x, s, t) {\r\n    var n = a + (b ^ c ^ d) + (x >>> 0) + t;\r\n    return ((n << s) | (n >>> (32 - s))) + b;\r\n  };\r\n  md5._ii  = function (a, b, c, d, x, s, t) {\r\n    var n = a + (c ^ (b | ~d)) + (x >>> 0) + t;\r\n    return ((n << s) | (n >>> (32 - s))) + b;\r\n  };\r\n\r\n  // Package private blocksize\r\n  md5._blocksize = 16;\r\n  md5._digestsize = 16;\r\n\r\n  module.exports = function (message, options) {\r\n    if (message === undefined || message === null)\r\n      throw new Error('Illegal argument ' + message);\r\n\r\n    var digestbytes = crypt.wordsToBytes(md5(message, options));\r\n    return options && options.asBytes ? digestbytes :\r\n        options && options.asString ? bin.bytesToString(digestbytes) :\r\n        crypt.bytesToHex(digestbytes);\r\n  };\r\n\r\n})();\r\n","(function() {\n  var base64map\n      = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',\n\n  crypt = {\n    // Bit-wise rotation left\n    rotl: function(n, b) {\n      return (n << b) | (n >>> (32 - b));\n    },\n\n    // Bit-wise rotation right\n    rotr: function(n, b) {\n      return (n << (32 - b)) | (n >>> b);\n    },\n\n    // Swap big-endian to little-endian and vice versa\n    endian: function(n) {\n      // If number given, swap endian\n      if (n.constructor == Number) {\n        return crypt.rotl(n, 8) & 0x00FF00FF | crypt.rotl(n, 24) & 0xFF00FF00;\n      }\n\n      // Else, assume array and swap all items\n      for (var i = 0; i < n.length; i++)\n        n[i] = crypt.endian(n[i]);\n      return n;\n    },\n\n    // Generate an array of any length of random bytes\n    randomBytes: function(n) {\n      for (var bytes = []; n > 0; n--)\n        bytes.push(Math.floor(Math.random() * 256));\n      return bytes;\n    },\n\n    // Convert a byte array to big-endian 32-bit words\n    bytesToWords: function(bytes) {\n      for (var words = [], i = 0, b = 0; i < bytes.length; i++, b += 8)\n        words[b >>> 5] |= bytes[i] << (24 - b % 32);\n      return words;\n    },\n\n    // Convert big-endian 32-bit words to a byte array\n    wordsToBytes: function(words) {\n      for (var bytes = [], b = 0; b < words.length * 32; b += 8)\n        bytes.push((words[b >>> 5] >>> (24 - b % 32)) & 0xFF);\n      return bytes;\n    },\n\n    // Convert a byte array to a hex string\n    bytesToHex: function(bytes) {\n      for (var hex = [], i = 0; i < bytes.length; i++) {\n        hex.push((bytes[i] >>> 4).toString(16));\n        hex.push((bytes[i] & 0xF).toString(16));\n      }\n      return hex.join('');\n    },\n\n    // Convert a hex string to a byte array\n    hexToBytes: function(hex) {\n      for (var bytes = [], c = 0; c < hex.length; c += 2)\n        bytes.push(parseInt(hex.substr(c, 2), 16));\n      return bytes;\n    },\n\n    // Convert a byte array to a base-64 string\n    bytesToBase64: function(bytes) {\n      for (var base64 = [], i = 0; i < bytes.length; i += 3) {\n        var triplet = (bytes[i] << 16) | (bytes[i + 1] << 8) | bytes[i + 2];\n        for (var j = 0; j < 4; j++)\n          if (i * 8 + j * 6 <= bytes.length * 8)\n            base64.push(base64map.charAt((triplet >>> 6 * (3 - j)) & 0x3F));\n          else\n            base64.push('=');\n      }\n      return base64.join('');\n    },\n\n    // Convert a base-64 string to a byte array\n    base64ToBytes: function(base64) {\n      // Remove non-base-64 characters\n      base64 = base64.replace(/[^A-Z0-9+\\/]/ig, '');\n\n      for (var bytes = [], i = 0, imod4 = 0; i < base64.length;\n          imod4 = ++i % 4) {\n        if (imod4 == 0) continue;\n        bytes.push(((base64map.indexOf(base64.charAt(i - 1))\n            & (Math.pow(2, -2 * imod4 + 8) - 1)) << (imod4 * 2))\n            | (base64map.indexOf(base64.charAt(i)) >>> (6 - imod4 * 2)));\n      }\n      return bytes;\n    }\n  };\n\n  module.exports = crypt;\n})();\n","/*!\n * Determine if an object is a Buffer\n *\n * @author   Feross Aboukhadijeh <https://feross.org>\n * @license  MIT\n */\n\n// The _isBuffer check is for Safari 5-7 support, because it's missing\n// Object.prototype.constructor. Remove this eventually\nmodule.exports = function (obj) {\n  return obj != null && (isBuffer(obj) || isSlowBuffer(obj) || !!obj._isBuffer)\n}\n\nfunction isBuffer (obj) {\n  return !!obj.constructor && typeof obj.constructor.isBuffer === 'function' && obj.constructor.isBuffer(obj)\n}\n\n// For Node v0.10 support. Remove this eventually.\nfunction isSlowBuffer (obj) {\n  return typeof obj.readFloatLE === 'function' && typeof obj.slice === 'function' && isBuffer(obj.slice(0, 0))\n}\n"],"names":["window","grin","tag","type","before","after","myField","document","getElementById","selectionStart","startPos","endPos","selectionEnd","cursorPos","value","substring","length","focus","charenc","utf8","stringToBytes","str","bin","unescape","encodeURIComponent","bytesToString","bytes","decodeURIComponent","escape","i","push","charCodeAt","String","fromCharCode","join","module","exports","lightBoxCSS","article_attach","collapseButtons","getElementsByClassName","collapseListener","e","slideToggle","currentTarget","nextElementSibling","ele","addEventListener","collapse","async","_iro","baguetteBox","loadCSS","resolvePath","default","run","captions","element","getElementsByTagName","alt","ignoreClass","fancybox","jQuery","Function","$","ext_shared_lib","importExternal","lightGallery","initLightGallery","lightbox","theme_mathjax","querySelector","textContent","match","mathjaxConfig","tex","inlineMath","startup","typeset","chtml","fontURL","mathmlSpacing","MathJax","typesetPromise","math","get_gravatar","email","size","gravatar_url","MD5","getqqinfo","is_get_by_qq","i_author","i_qq","i_email","i_url","qq_check","gravatar_check","user_avatar_img","localStorage","getItem","setAttribute","qzone_autocomplete","style","display","emailAddressFlag","qq","test","whileFailed","setItem","fetch","buildAPI","qq_api_url","then","resp","ok","data","json","name","trim","avatar","console","warn","emailAddress","URL_Address","user_name","AddComment","respondId","moveForm","commId","parentId","comm","respond","cancel","parent","this","div","createElement","id","parentNode","insertBefore","nextSibling","temp","remove","_respond","scrollTo","top","getBoundingClientRect","pageYOffset","clientTop","behavior","onclick","t","PaginationListener","target","preventDefault","stopPropagation","classList","contains","add","dataset","href","nonce","method","res","Error","status","insertAdjacentHTML","lazyload","catch","error","createButterbar","innerHTML","LoadNextPage","sections","_flag","prepareEmoji","emojiPanelButton","emojiPanel","header","commentTextArea","removeEventListener","closeEmojiPanel","moveDrag","endDrag","startDrag","initFooter","getAttribute","btnRect","panelWidth","offsetWidth","panelHeight","offsetHeight","leftPos","left","scrollX","width","getComputedStyle","position","topPos","bottom","innerHeight","toggle","hasAttribute","passive","initEmojiPanel","offsetX","offsetY","isDragging","event","touches","clientX","offsetLeft","clientY","offsetTop","transition","row","tagName","querySelectorAll","className","container","initAnnotations","popup","body","appendChild","createAnnotationPopup","have_annotation","page_annotation","JSON","parse","Object","keys","annotationMarks","processedTerms","Set","forEach","mark","term","has","explanation","rect","closest","i18n_form","sakura_links","submitting","server_error","connection_error","timeout_error","invalid_url","invalid_email","security_error","captcha_load_error","refresh_captcha","currentLang","language","documentElement","lang","replace","includes","initLinkSubmission","i18n","submitButton","linkModal","closeButton","linkForm","captchaImg","patternTitle","handleModalOpen","overflow","loadCaptcha","handleModalClose","enableScroll","handleOutsideClick","overflowY","cleanup","handleFormSubmit","isSubmitting","submissionTimeout","submissionLock","log","Promise","resolve","setTimeout","clearTimeout","siteName","siteUrl","siteDescription","siteImage","contactEmail","captcha","timestampInput","idInput","nonceInput","displayStatus","siteUrlValue","urlPattern","siteImageValue","xssPattern","validateForm","disabled","formData","FormData","append","ajaxUrl","ajaxurl","fetchPromise","credentials","timeoutPromise","_","reject","response","race","text","success","message","reset","captchaInput","src","endpointUrl","captcha_endpoint","timestamp","Date","now","endpoint","cache","headers","responseText","undefined","code","msg","time","statusElement","_statusUpdateTimeout","sanitizedMessage","c","defaultStyles","minWidth","margin","background","borderBottom","padding","fontSize","init_steamCard","applySteamProfileStyles","resize_SteamCard","profile","gameInfo","profileHeader","username","init","resizeTimer","resizeCard","checkDark","dark","ghcardDark","ifDarkmodeShouldOn","darkmode","turn","cards","ghcard","card","URL","searchParams","set","toString","delete","Timeline","constructor","timelineRoot","modalMask","modalContent","modalClose","boundHandleClick","handleClick","bind","boundHandleModalClose","boundHandleMaskClick","handleMaskClick","htmlLang","toLowerCase","some","variant","startsWith","categoryRoot","modalMain","contentAPI","archiveapi","contents","timelineInstance","FetchContents","bindEvents","retryError","destroy","matches","yearCard","year","yearData","filterByYear","renderModal","showModal","categoryCard","catId","parseInt","categoryid","categoryData","filterByCategory","close","result","months","entries","month","posts","matched","filter","post","Array","isArray","categories","label","totalStats","views","words","comments","typeStats","shuoshuo","article","values","monthObj","meta","comment_count","yearOverview","categoryOverview","articleCount","articles","readCount","times","wordCount","characters","commentCount","html","toFixNum","monthsDesc","sort","a","b","monthsObj","monthTitle","slice","post_date","date","formattedDate","getMonth","getDate","postType","link","post_title","initTimeArchive","num","toFixed","visibilityHandler","scrollHandler","videoClickHandler","appClickHandler","appObserverInstance","imgObserverInstance","videoContainer","isInitialized","isAdmin","app","disconnect","initBilibiliFavList","restApiUrl","iro_api","wpnonce","state","folders","currentFolder","loading","pageSize","currentItems","currentPage","totalPages","lastDataUpdate","fromCache","cacheExpiresIn","cacheAge","Map","getKey","folderId","page","key","lsKey","stringify","get","item","savedData","parsed","removeItem","isValid","cachedItem","initApp","fetchAllFolders","renderApp","setupScrollEffects","setupImageLazyLoading","setupVideoModal","setupVideoItemsClickEvent","setupScrollAnimations","showError","forceRefresh","fetchFolderItems","url","Pragma","list","cachedData","folderData","medias","Math","ceil","info","media_count","floor","fetchFolderItemsFromNetwork","cache_info","from_cache","expires_in","isUpdate","folderSelectorHtml","renderFolderSelector","contentHtml","renderLoadingSkeleton","renderCurrentFolder","existingContent","wasSkeleton","renderNewContent","bindAppContainerEvents","index","transitionDelay","requestAnimationFrame","itemsToExit","totalExitDuration","waitTimeForNewContent","max","EXIT_STAGGER_DELAY","skeletonHtml","refreshButtonHtml","map","folder","title","find","renderFavItem","renderPagination","bvid","cover","upper","intro","paginationHtml","startPage","maxPagesToShow","endPage","min","refreshBtn","lastRefreshTs","remainingTime","refreshTextSpan","currentBtn","currentTextSpan","currentRefreshBtn","tabEl","pageBtn","scrollToTop","bindGlobalEvents","lastVisibilityChange","needReloadOnReturn","visibilityState","timeAway","contentArea","itemObserver","IntersectionObserver","entry","isIntersecting","unobserve","threshold","rootMargin","animationDelay","observe","appMutationCallback","mutationsList","mutation","addedNodes","node","nodeType","img","debounce","func","wait","timeout","args","apply","items","viewportHeight","observer","obs","placeholder","previousElementSibling","onload","onerror","imgError","removeAttribute","closeVideoModal","iframe","transform","opacity","handleFavItemClick","favItem","upName","MutationObserver","childList","subtree","init_comment_captcha","captchaHideTimeout","captchaField","refreshCaptcha","showCaptcha","hideCaptcha","loaded","marginRight","iroCaptcha","cfturnstile","theme","loadTurnstile","script","head","turnstile","render","sitekey","callback","token","cfts","apply_post_theme_color","post_theme_color","setProperty","removeProperty","click_to_view_image","open","original_emoji_click","innerText","XCS","__list","form","statusSubmitting","butterBarRef","__","attributes","from","addComment","order","formpostion","dispatchEvent","CustomEvent","statusText","reason","finally","sm","cm","data_commentid","confirm","alert","idp","actionp","rateHolderp","ajax_data","request","XMLHttpRequest","onreadystatechange","readyState","setRequestHeader","send","resizeTOC","toc_container","sc","resize","height","debounced","clear","fn","maxTimelong","startTime","curTime","throttling","tableOfContentScroll","flag","tocContainer","tocbot","tocSelector","contentSelector","headingSelector","headingsOffset","heading_fix","onClick","entry_content_style","_els","idSet","_el","validId","generateValidId","detail","newId","add_upload_tips","comment_upload_img","cached","upload_img","files","max_size","img_upload_max_size","alerts","f","xhr","api","get_the_url","proxy","loading_ph","_$","attach_image","file_submit","hover","Tip","afterAjaxCommentComplete","code_highlight_style","whilePopstate","stlye","is_admin","bili_fav_init","ready","nodeName","_this","path","pathname","_xhr","responseType","onloadstart","comments_navi","commentwrap","loading_comments","comments_list","nextlink","outerHTML","gtag","google_analytics_id","crypt","isBuffer","md5","options","encoding","prototype","call","Uint8Array","m","bytesToWords","l","d","FF","_ff","GG","_gg","HH","_hh","II","_ii","aa","bb","cc","dd","endian","x","s","n","_blocksize","_digestsize","digestbytes","wordsToBytes","asBytes","asString","bytesToHex","base64map","rotl","rotr","Number","randomBytes","random","hex","hexToBytes","substr","bytesToBase64","base64","triplet","j","charAt","base64ToBytes","imod4","indexOf","pow","obj","readFloatLE","isSlowBuffer","_isBuffer"],"sourceRoot":""}